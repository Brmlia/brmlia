{"version":3,"sources":["ui/assets/images/brom.jpeg","ui/style.js","mainSettings.js","fileuploader/fileStore.js","imagecanvas/ImageStore.js","utils/index.js","ui/components/zoom/zoomSettings.js","ui/components/zoom/zpp.js","ui/components/slider.js","ui/components/zoom/zoomControl.js","ui/components/zoom/zoom.js","viewer/index.js","imagecanvas/Mesh.js","imagecanvas/canvasStore.js","annotator/annotationStore.js","annotator/annotationControl.js","annotator/annotationMenuOptions.js","annotator/editControl.js","annotator/annotationSettings.js","annotator/annotationClass.js","ui/components/FabricLayer.js","annotator/annotationSubMenu.js","annotator/annotationMenu.js","fabric/fabricControl.js","datacube/volume.js","datacube/datacubeControls.js","datacube/cachedImageData.js","datacube/datacube.js","ui/components/mainTiffViewer.js","ui/components/mainViewer.js","ui/components/axisTiffViewer.js","ui/components/axesViewer.js","ui/components/annotatorViewer.js","ui/components/thumbnails.js","annotator/annotStore.js","annotator/importer.js","fileuploader/fileControl.js","fileuploader/index.js","annotator/exporter.js","ui/components/menus.js","annotator/index.js","imagecanvas/CanvasControl.js","imagecanvas/ImageCanvas.js","ui/components/colorPicker.js","ui/components/channel.js","ui/components/channelViewer.js","ui/index.js","index.js"],"names":["module","exports","mainStyle","overflowY","overflowX","height","width","position","rowStyle","flex","cardStyle","buttonGroup","size","vertical","padding","container","fluid","maxWidth","card","justify","alignContent","alignItems","textAlign","fontSize","cardBody","mainImg","mainCanvasStyle","zIndex","marginLeft","opacity","canvasStyle1","canvasStyle2","canvasStyle3","canvasThumbnail","thumb","display","borderRadius","border","marginBottom","marginRight","boxSizing","thumbInner","minWidth","overflow","initState","channels","selected","lastSelected","dev","create","set","settingsApi","updateChannelSel","channel","setState","prevState","map","ch","j","newChannel","updateLastSel","prodState","file","devState","name","image","require","style","type","getState","fileApi","createTexture","THREE","load","createTextureFromTiff","uniforms","brightness","value","contrast","whitepoint","blackpoint","color","texture","update","state","uniApi","fApi","uApi","zoomState","views","zoomPct","zoomZppPct","reset","last","useZoomApi","zpp","limitToBounds","panningEnabled","transformEnabled","pinchEnabled","limitToWrapper","disabled","dbClickEnabled","lockAxisX","lockAxisY","velocityEqualToMove","enableWheel","enableTouchPadPinch","enableVelocity","limitsOnWheel","minScale","maxScale","step","updated","scale","x","y","Zpp","props","subscribe","length","className","defaultScale","defaultPositionX","defaultPositionY","positionX","positionY","options","pan","velocity","pinch","doubleClick","wheel","wheelEnabled","touchPadEnabled","zoomIn","zoomOut","resetTransform","setDefaultState","previousScale","updateXY","Fragment","imageWidth","src","alt","view","img","Number","toFixed","Slider","initSlider","initial","min","max","handleSliderChange","e","persist","slider","target","updateStatus","notifyValue","setSlider","sync","this","status","sliderValue","raw","Math","round","multiplier","label","id","onChange","displayValue","Component","updateZoom","idx","vw","parseInt","newView","newReset","Zoom","bind","onClick","Viewer","zoom","api","init","forceUpdate","zppZoom","withFileStore","Mesh","ref","useRef","material","useMemo","useFrame","current","attach","args","fragmentShader","vertexShader","meshState","mesh","canvasState","canvas","canvasApi","annotations","cachedState","cachedAnnots","annotApi","cachedAnnotApi","addAnnotation","group","classLabel","class","undoAnnotation","index","annotation","splice","deleteAnnotation","getLastAnnotIdx","updateAnnotationLabel","oldLabel","annot","newAnnot","updateAnnotClassLabel","editAnnotationLabel","obj","getSelectedObjects","_objects","object","ungroup","objs","i","text","getCanvas","renderAll","regroup","updateLabel","updateSelect","editAnnotationClass","updateClassLabel","menu","displayon","coords","items","setDisplay","objects","select","AnnotationMenuApi","sel","classes","addClass","annotClassApi","enabled","updateClasses","push","getAnnotationClasses","cls","isDuplicateClass","enableClass","newCls","filter","getClasses","colors","drawFreeStyle","window","isMouseDown","isDrawingMode","freeDrawingBrush","purple","drawRect","rect","fRect","fabric","Rect","left","top","fill","stroke","strokeLineJoin","strokeWidth","objectCaching","Group","on","moving","o","setCoords","newLabel","IText","originX","originY","fontFamily","fontWeight","textBackgroundColor","classText","perPixelTargetFind","add","setActiveObject","addWithUpdate","_restoreObjectsState","remove","item","hasControls","filterAnnotations","getObjects","class_element","markGroupVisible","markGroupInvisible","discardActiveObject","markVisible","visible","dirty","redo","cachedAnnot","AnnotationSubMenu","handleChange","changeLabel","changeClassLabel","button","labelTop","match","buttonLeft","event","newStr","React","AnnotationMenu","contextRef","createRef","returnMenu","updateItems","updateCoords","updateDisplay","arr","key","callback","modes","mouse","down","origin","drawMode","fabricApi","setMode","newMode","startSelecting","startDrawing","_offset","setOrigin","startDrawingRect","finish","finishDrawingRect","setFabricCoords","abs","getActiveObjects","canvasLeft","canvasRight","canvasTop","canvasBottom","relX","relY","openMenu","setMenuCoords","FabricLayer","canvasRef","handleMouseDown","handleMouseUp","handleMouseDoubleClick","handleDrag","selectClass1","showAll","showAllClasses","handleMoveAnnotation","Canvas","fireRightClick","setFabricCanvas","mode","clientX","clientY","handleRightMouseDown","handleLeftMouseDown","handleRightMouseUp","handleLeftMouseUp","annots","addToFabric","onContextMenu","preventDefault","borderColor","borderWidth","borderStyle","displayMenu","Volume","segmentation","segments","requests","ctx","axis","slice","_this","grayImageSlice","pixels","Uint32Array","data","buffer","slice32","putImageData","loadVolume","cube","insertImageData","loaded","stateApi","loadSlices","cntxt","volume","axes","files","a","_loadSlicesFromMultipageFile","_loadSlicesFromMultipleFiles","updateChannelSlice","renderChannelSlice","_loadVolumes","pages","pIdx","page","pct","console","log","fIdx","ProgressBar","Progress","striped","bar","CachedImageData","context","cache","createImageData","DataCube","bytes","z","canvas_context","materialize","cached_imgdata","clean","faces","face","ArrayType","arrayType","imgdata","offsetx","offsety","offsetz","data32","mask","true","1","2","4","false","isLittleEndian","sizex","zadj","copy","Error","xsize","ysize","zsize","xysize","byteoffset","buf","square","yoffset","transparency","faceDimensions","sizes","getImageData","alpha","arr32","arr8","Uint8Array","islittle","r","g","b","Uint8ClampedArray","Uint16Array","undefined","mainTiffViewer","axisIdx","sliceIdx","fileLength","getContext","val","updateForFile","mainViewer","Card","CardBody","CardTitle","view1","view2","view3","fabricCanvas1","fabricCanvas2","fabricCanvas3","canvasZIndex","channelViews","canvasView","TiffViewer","dec","clamp","sliderValueSlice","nextSlice","AxesViewer","AnnotatorViewer","futureClass","futureAnnotClass","annotClasses","enables","annotCls","num","includes","en","divs","Button","outline","active","updateAnnotClasses","Thumbnails","classicImage","setSelected","allThumbs","elements","allTiffsCanvas","loadTiff","margin","tiffFiles","newFile","rgba","imageData","imgW","imgH","newC","document","createElement","drawImage","f","shrinkTiff","img_name","importCsv","reader","FileReader","onload","fileAsBinaryString","result","csv","noheader","output","fromString","then","csvRows","toJson","forEach","aCsvRow","builtObject","Object","keys","aKey","valueToAddInBuiltObject","keyToAddInBuiltObject","saveJson","onabort","onerror","readAsText","importJson","JSON","parse","importTiff","debug","onloadend","ifds","UTIF","decode","decodeImage","toRGBA8","Image","updateTiffPages","parseMultiTiff","onprogress","readAsArrayBuffer","isAnnotValid","json","concat","addJsonAnnot","addFile","preview","addPng","addTiff","addCsv","addJson","initFile","initPng","initTiff","initCsv","initJson","FileUpload","useState","setFiles","useDropzone","accept","onDrop","acceptedFiles","assign","URL","createObjectURL","getRootProps","getInputProps","validFile","isValidFile","useEffect","revokeObjectURL","exportJson","element","Blob","stringify","href","download","body","appendChild","click","Menus","ButtonGroup","UncontrolledButtonDropdown","DropdownToggle","caret","DropdownMenu","DropdownItem","undo","Annotator","file_size","isValidChannel","updateImage","blob","prevStateCh","imagepath","updateUniformImage","updateBrightness","updateUniformBrightness","updateContrast","updateUniformContrast","updateWhitepoint","updateUniformWhitepoint","updateBlackpoint","updateUniformBlackpoint","updateOpacity","updateUniformOpacity","updateColor","updateUniformColor","ImageCanvas","updateForControls","ColorPicker","displayColorPicker","handleClick","handleClose","rgb","handleChangeComplete","hex","styles","reactCSS","default","background","swatch","boxShadow","cursor","popover","cover","right","bottom","onChangeComplete","Channel","updateSelection","sliderValueBr","sliderValueCt","sliderValueWp","sliderValueBp","sliderValueOpc","colorValue","UncontrolledCollapse","toggler","resetOpacity","resetBrightness","resetContrast","resetWhitepoint","resetBlackpoint","ChannelViewer","UI","Container","Row","Col","xs","Application","rootElement","getElementById","ReactDOM","render"],"mappings":"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","file":"static/js/main.a5015433.chunk.js","sourcesContent":["module.exports = \"data:image/jpeg;base64,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\"","export const mainStyle = {\n  overflowY: 'scroll',\n  overflowX: 'scroll',\n  height: '100%',\n  width: '100%',\n  // height: '500px',\n  // width: '900px',\n  position: 'relative',\n};\nexport const containerStyle = {\n  width: '900px',\n  marginLeft: 0,\n};\nexport const rowStyle = {\n  flex: 1.0,\n  position: 'relative',\n};\nexport const cardStyle = {\n  flex: 0.1,\n  position: 'relative',\n};\n\nexport const buttonGroup = {\n  size: 'sm',\n  vertical: false,\n  flex: 1.0,\n  padding: 15,\n};\n\nexport const mainView = {\n  flex: 1,\n  flexDirection: 'column',\n  justifyContent: 'center',\n  maxWidth: '20%',\n};\n\nexport const innerView = {\n  flex: 0.8,\n  flexDirection: 'row',\n};\n\nexport const container = {\n  fluid: true,\n  maxWidth: '100%',\n};\n\nexport const row = {\n  noGutters: false,\n  form: false,\n  xs: '2',\n};\n\nexport const col = {\n  xs: '2',\n};\n\nexport const card = {\n  justify: 'center',\n  alignContent: 'center',\n  alignItems: 'center',\n  textAlign: 'center',\n  width: '100%',\n  fluid: true,\n  fontSize: '12px',\n};\n\nexport const cardBody = {\n  width: '85%',\n  height: '100%',\n};\n\nexport const mainImg = {\n  width: '100%',\n};\n\nexport const axesImg = {\n  width: '100%',\n};\n\nexport const mainCanvasStyle = {\n  position: 'absolute',\n  height: '100%',\n  width: '100%',\n  zIndex: '3',\n  marginLeft: '0px',\n  opacity: '1.0',\n};\n\nexport const canvasStyle1 = {\n  position: 'absolute',\n  height: '100%',\n  width: '100%',\n  zIndex: '3',\n  // marginLeft: '100px',\n  opacity: '0.5',\n};\nexport const canvasStyle2 = {\n  position: 'absolute',\n  height: '100%',\n  width: '100%',\n  zIndex: '5',\n  // marginLeft: '50px',\n  opacity: '0.5',\n};\nexport const canvasStyle3 = {\n  position: 'absolute',\n  height: '100%',\n  width: '100%',\n  zIndex: '7',\n  opacity: '0.5',\n};\n\nexport const canvasThumbnail = {\n  position: 'center',\n  height: '100px',\n  width: '88px',\n  zIndex: '3',\n};\n\nexport const thumbsContainer = {\n  display: 'flex',\n  flexDirection: 'row',\n  flexWrap: 'wrap',\n  marginTop: 16,\n};\n\nexport const thumb = {\n  display: 'inline-flex',\n  borderRadius: 2,\n  border: '1px solid #eaeaea',\n  marginBottom: 8,\n  marginRight: 8,\n  width: 50,\n  height: 50,\n  padding: 4,\n  boxSizing: 'border-box',\n};\n\nexport const thumbInner = {\n  display: 'flex',\n  minWidth: 0,\n  overflow: 'hidden',\n};\n","import create from 'zustand';\n\nexport const initState = {\n  channels: [\n    {\n      selected: false,\n    },\n    {\n      selected: false,\n    },\n    {\n      selected: false,\n    },\n  ],\n  lastSelected: 1,\n  dev: 0,\n};\n\nexport const [useMainSettings, settingsApi] = create(set => ({\n  ...initState,\n}));\n\nexport function updateChannelSel(channel) {\n  settingsApi.setState(prevState => {\n    const channels = prevState.channels.map((ch, j) => {\n      if (j === channel - 1) {\n        var newChannel = ch;\n        newChannel.selected = !prevState.channels[j].selected;\n        return newChannel;\n      } else {\n        return ch;\n      }\n    });\n    return {\n      channels,\n    };\n  });\n}\n\nexport function updateLastSel(channel) {\n  settingsApi.setState(prevState => ({\n    ...prevState,\n    lastSelected: channel,\n  }));\n}\n","import create from 'zustand';\nimport { settingsApi } from '../mainSettings.js';\n\nexport const initState = () => {\n  return settingsApi.getState().dev ? devState : prodState;\n};\n\nexport const prodState = {\n  file: [],\n  size: 0,\n  selected: 0,\n};\n\nexport const devState = {\n  file: [\n    {\n      name: 'brom.jpeg',\n      image: require('./../ui/assets/images/brom.jpeg'),\n      style: {\n        display: 'block',\n        width: 'auto',\n        height: '100%',\n      },\n      type: 'image/png',\n    },\n  ],\n  size: 1,\n  selected: 0,\n};\n\nexport const [useFileStore, fileApi] = create(set => ({\n  ...initState(),\n}));\n","import create from 'zustand';\nimport * as THREE from 'three';\n\nexport const createTexture = image => {\n  return new THREE.TextureLoader().load(image);\n};\n\nexport const createTextureFromTiff = image => {\n  return new THREE.TextureLoader().load(image);\n};\n\nconst initState = {\n  channels: [\n    {\n      uniforms: {\n        brightness: {\n          value: '0.0',\n        },\n        contrast: {\n          value: '0.0',\n        },\n        whitepoint: {\n          value: '255.0',\n        },\n        blackpoint: {\n          value: '0.0',\n        },\n        opacity: {\n          value: '0.0',\n        },\n        color: {\n          value: '',\n        },\n        image: {\n          value: '',\n        },\n      },\n      texture: null,\n      name: '',\n      type: '',\n    },\n    {\n      uniforms: {\n        brightness: {\n          value: '0.0',\n        },\n        contrast: {\n          value: '0.0',\n        },\n        whitepoint: {\n          value: '235.0',\n        },\n        blackpoint: {\n          value: '16.0',\n        },\n        opacity: {\n          value: '0.0',\n        },\n        color: {\n          value: '',\n        },\n        image: {\n          value: '',\n        },\n      },\n      texture: null,\n      name: '',\n      type: '',\n    },\n    {\n      uniforms: {\n        brightness: {\n          value: '0.0',\n        },\n        contrast: {\n          value: '0.0',\n        },\n        whitepoint: {\n          value: '235.0',\n        },\n        blackpoint: {\n          value: '16.0',\n        },\n        opacity: {\n          value: '0.0',\n        },\n        color: {\n          value: '',\n        },\n        image: {\n          value: '',\n        },\n      },\n      texture: null,\n      name: '',\n      type: '',\n    },\n    {\n      uniforms: {\n        brightness: {\n          value: '0.0',\n        },\n        contrast: {\n          value: '0.0',\n        },\n        whitepoint: {\n          value: '235.0',\n        },\n        blackpoint: {\n          value: '16.0',\n        },\n        opacity: {\n          value: '0.0',\n        },\n        color: {\n          value: '',\n        },\n        image: {\n          value: '',\n        },\n      },\n      texture: null,\n      name: '',\n      type: '',\n    },\n  ],\n};\n\nexport const [useUniformStore, uniApi] = create(set => ({\n  ...initState,\n  update: (brightness, contrast, whitepoint, blackpoint, opacity, color, image) =>\n    set(state => ({\n      ...state,\n      uniforms: {\n        ...state.uniforms,\n        brightness: {\n          ...state.uniforms.brightness,\n          value: brightness,\n        },\n        contrast: {\n          ...state.uniforms.contrast,\n          value: contrast,\n        },\n        whitepoint: {\n          ...state.uniforms.whitepoint,\n          value: whitepoint,\n        },\n        blackpoint: {\n          ...state.uniforms.blackpoint,\n          value: blackpoint,\n        },\n        opacity: {\n          ...state.uniforms.opacity,\n          value: opacity,\n        },\n        color: {\n          ...state.uniforms.color,\n          value: color,\n        },\n        image: {\n          ...state.uniforms.image,\n        },\n      },\n      texture: image,\n      brightness: brightness,\n    })),\n}));\n","import React from 'react';\n\nimport { fileApi } from '../fileuploader/fileStore.js';\nimport { uniApi } from '../imagecanvas/ImageStore.js';\n\nexport const fApi = fileApi;\nexport const uApi = uniApi;\n\nexport const withFileStore = (Component: any) => {\n  return (props: any) => {\n    return <Component api={fApi} {...props} />;\n  };\n};\n\nexport const withUniformStore = (Component: any) => {\n  return (props: any) => {\n    return <Component api={uApi} {...props} />;\n  };\n};\n\nexport const withStore = (Component: any) => {\n  return (props: any) => {\n    return <Component uApi={uApi} fApi={fApi} {...props} />;\n  };\n};\n","import create from 'zustand';\n\nexport const zoomState = {\n  views: [\n    {\n      name: 'main',\n      zoomPct: '1',\n      zoomZppPct: '1',\n      reset: '0',\n    },\n    {\n      name: 'xy',\n      zoomPct: '1',\n      zoomZppPct: '1',\n      reset: '0',\n    },\n    {\n      name: 'yz',\n      zoomPct: '1',\n      zoomZppPct: '1',\n      reset: '0',\n    },\n    {\n      name: 'xz',\n      zoomPct: '1',\n      zoomZppPct: '1',\n      reset: '0',\n    },\n  ],\n  last: '0',\n};\n\nexport const [useZoomStore, useZoomApi] = create(set => ({\n  ...zoomState,\n}));\n","import React from 'react';\n\nimport { TransformWrapper, TransformComponent } from 'react-zoom-pan-pinch';\nimport { useZoomApi } from './zoomSettings.js';\n// import { updateZppZoom } from \"./zoomControl.js\";\n\nvar state = {\n  zpp: {\n    type: true,\n    limitToBounds: true,\n    panningEnabled: true,\n    transformEnabled: true,\n    pinchEnabled: false,\n    limitToWrapper: false,\n    disabled: false,\n    dbClickEnabled: true,\n    lockAxisX: false,\n    lockAxisY: false,\n    velocityEqualToMove: true,\n    enableWheel: true,\n    enableTouchPadPinch: false,\n    enableVelocity: true,\n    limitsOnWheel: false,\n    minScale: 0.5,\n    maxScale: 8,\n    step: 10,\n    updated: false,\n    scale: 1,\n    x: 0,\n    y: 0,\n  },\n  zoomPct: 100,\n};\n\nfunction updateZoomValue(value, idx) {\n  if (state.zoomPct !== value) {\n    state.zoomPct = value;\n    // updateZppZoom(value, idx)\n  }\n}\n\nfunction updateZppZoomValue(value, idx) {\n  if (state.zoomPct !== value) {\n    state.zoomPct = value;\n  }\n}\n\nfunction updateXY(x, y) {\n  if (state.zpp.x !== x) {\n    state.zpp.x = x;\n  }\n  if (state.zpp.y !== y) {\n    state.zpp.y = y;\n  }\n}\n\nfunction reset() {\n  state.zpp.x = 0;\n  state.zpp.y = 0;\n}\n\nfunction view(image, imageWidth) {\n  if (image !== '') {\n    return <img src={image} alt=\"viewer\" width={imageWidth} />;\n  }\n}\n\nfunction Zpp(props) {\n  const {\n    limitToBounds,\n    panningEnabled,\n    transformEnabled,\n    pinchEnabled,\n    limitToWrapper,\n    disabled,\n    dbClickEnabled,\n    lockAxisX,\n    lockAxisY,\n    velocityEqualToMove,\n    enableWheel,\n    enableTouchPadPinch,\n    enableVelocity,\n    limitsOnWheel,\n    minScale,\n    maxScale,\n    step,\n    x,\n    y,\n  } = state.zpp;\n\n  useZoomApi.subscribe(state => {\n    if (\n      state &&\n      state.views &&\n      props.type >= 0 &&\n      props.type < state.views.length\n    ) {\n      updateZppZoomValue(state.views[props.type].zoomPct, props.type);\n    }\n\n    if (state.views[props.type].reset) reset();\n  });\n\n  return (\n    <div className=\"transform-wrapper\">\n      <TransformWrapper\n        defaultScale={1}\n        defaultPositionX={0}\n        defaultPositionY={0}\n        positionX={x}\n        positionY={y}\n        scale={state.zoomPct / 100}\n        options={{\n          limitToBounds,\n          transformEnabled,\n          disabled,\n          limitToWrapper,\n          minScale,\n          maxScale,\n        }}\n        pan={{\n          disabled: !panningEnabled,\n          lockAxisX,\n          lockAxisY,\n          velocityEqualToMove,\n          velocity: enableVelocity,\n        }}\n        pinch={{ disabled: !pinchEnabled }}\n        doubleClick={{ disabled: !dbClickEnabled }}\n        wheel={{\n          wheelEnabled: enableWheel,\n          touchPadEnabled: enableTouchPadPinch,\n          limitsOnWheel,\n          step: step,\n        }}\n      >\n        {({\n          zoomIn,\n          zoomOut,\n          resetTransform,\n          setDefaultState,\n          positionX,\n          positionY,\n          scale,\n          previousScale,\n          options: { limitToBounds, transformEnabled, disabled },\n          ...rest\n        }) => (\n          <div>\n            {updateZoomValue(scale * 100, props.type)}\n            {updateXY(positionX, positionY)}\n            <React.Fragment>\n              <TransformComponent>\n                {view(props.img, props.imageWidth)}\n              </TransformComponent>\n              <span className=\"badge badge-primary\">\n                x : {Number(positionX).toFixed(0)}px\n              </span>\n              <span className=\"badge badge-primary\">\n                y : {Number(positionY).toFixed(0)}px\n              </span>\n              <span className=\"badge badge-primary\">\n                Scale : {Number(scale * 100).toFixed(0)}%\n              </span>\n            </React.Fragment>\n          </div>\n        )}\n      </TransformWrapper>\n    </div>\n  );\n}\n\nexport default Zpp;\n","import React, { Component } from 'react';\nimport './../styles.css';\nimport { useZoomApi } from './zoom/zoomSettings.js';\n\nclass Slider extends Component {\n  initSlider = {\n    initial: 0,\n    min: 0,\n    max: 0,\n    step: 0,\n    value: 0,\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      updated: false,\n      slider: this.initSlider,\n      setSlider: null,\n      sync: true,\n    };\n  }\n\n  componentDidUpdate() {\n    if (this.state.updated) {\n      return true;\n    }\n    return false;\n  }\n\n  updateStatus(status) {\n    let updated = true;\n    this.setState({ updated: updated });\n  }\n\n  notifyValue() {\n    var sliderValue = this.props.sliderValue;\n    const type = this.props.type;\n    sliderValue(this.state.slider.value, type);\n  }\n\n  displayValue() {\n    if (this.props.raw === '1') {\n      return (\n        <span>\n          {' '}\n          {Math.round(this.state.slider.value * this.props.multiplier)}\n        </span>\n      );\n    } else {\n      return (\n        <span>\n          {' '}\n          {Math.round(this.state.slider.value * this.props.multiplier)}%\n        </span>\n      );\n    }\n  }\n\n  handleSliderChange = e => {\n    e.persist();\n\n    let slider = this.state.slider;\n    slider.value = e.target.value;\n    this.setState({ slider: slider });\n\n    this.updateStatus(true);\n    this.notifyValue();\n  };\n\n  render() {\n    useZoomApi.subscribe(state => {\n      if (this.props.type >= 0 && this.props.type < state.views.length) {\n        let slider = this.state.slider;\n        slider.value = state.views[this.props.type].zoomPct;\n        this.setState({ slider: slider });\n      }\n    });\n\n    const slider = this.state.slider;\n    const { label, min, max, initial, step } = this.props;\n\n    return (\n      <div className=\"slider-settings\">\n        <span>{label}</span> <br></br>\n        <span>{min} </span>\n        <input\n          type=\"range\"\n          className=\"slider\"\n          value={slider.value || initial}\n          id=\"customRange1\"\n          initial={initial}\n          min={min}\n          max={max}\n          step={step}\n          onChange={e => this.handleSliderChange(e)}\n        />\n        <span> {max}</span>\n        <span> {this.displayValue()}</span>\n      </div>\n    );\n  }\n}\n\nexport default Slider;\n","import { useZoomApi } from './zoomSettings.js';\n\nexport function updateZoom(value, idx, reset) {\n  const currZoom = useZoomApi.getState().views[idx].zoomPct;\n\n  if (currZoom !== value || reset) {\n    useZoomApi.setState(prevState => {\n      const views = prevState.views.map((vw, j) => {\n        if (j === parseInt(idx)) {\n          var newView = vw;\n          var newReset = 0;\n          if (reset) {\n            newReset = 1;\n          }\n          newView.zoomPct = value;\n          newView.reset = newReset;\n          return newView;\n        } else {\n          return vw;\n        }\n      });\n      return {\n        views,\n      };\n    });\n\n    useZoomApi.setState(prevState => ({\n      ...prevState,\n      last: idx,\n    }));\n  }\n}\n\nexport function updateZppZoom(value, idx) {\n  const currZoom = useZoomApi.getState().views[idx].zoomZppPct;\n\n  if (currZoom !== value) {\n    useZoomApi.setState(prevState => {\n      const views = prevState.views.map((vw, j) => {\n        if (j === parseInt(idx)) {\n          var newView = vw;\n          newView.zoomZppPct = value;\n          return newView;\n        } else {\n          return vw;\n        }\n      });\n      return {\n        views,\n      };\n    });\n  }\n}\n","import React from 'react';\n\nimport Slider from '../slider.js';\n\nimport { useZoomApi } from './zoomSettings.js';\nimport { updateZoom } from './zoomControl.js';\n\nvar state = {\n  zoomPct: 100,\n};\n\nfunction resetZoom(idx) {\n  updateZoom('100', idx, true);\n}\n\nfunction updateZoomView(idx, value) {\n  if (state.zoomPct !== value) {\n    // updateZoom(value, idx);\n  }\n}\n\nfunction Zoom(props) {\n  useZoomApi.subscribe(state => {\n    if (\n      state &&\n      state.views &&\n      props.type >= 0 &&\n      props.type < state.views.length\n    ) {\n      updateZoomView(props.type, state.views[props.type].zoomZppPct);\n    }\n  });\n\n  return (\n    <div className=\"viewer-wrapper\">\n      <Slider\n        label=\"Zoom\"\n        width=\"40%\"\n        min=\"50\"\n        max=\"800\"\n        step=\"10\"\n        initial={state.zoomPct}\n        multiplier=\"1\"\n        sliderValue={updateZoom.bind(this)}\n        type={props.type}\n      />\n      <button\n        id=\"resetZoomBtn\"\n        onClick={() => {\n          resetZoom(props.type);\n        }}\n      >\n        Reset Zoom\n      </button>\n    </div>\n  );\n}\n\nexport default Zoom;\n","import React, { Component } from 'react';\nimport { withFileStore } from '../utils/index.js';\nimport '../styles.css';\n\nimport Zpp from '../ui/components/zoom/zpp.js';\nimport Zoom from '../ui/components/zoom/zoom.js';\nimport { useZoomApi } from '../ui/components/zoom/zoomSettings.js';\n\nclass Viewer extends Component {\n  state = {\n    image: '',\n    zoom: 0,\n  };\n\n  init() {\n    if (this.state.image === '') {\n      if (this.props.api.getState().file.length > 0) {\n        this.setState({\n          image: this.props.api.getState().file[\n            this.props.api.getState().selected\n          ].image,\n        });\n      }\n    }\n  }\n\n  render() {\n    this.init();\n    this.props.api.subscribe(state => {\n      if (state) {\n        const img = state.file[state.selected].image;\n        if (img) {\n          this.setState({\n            image: img,\n          });\n          this.forceUpdate();\n        }\n      }\n    });\n    useZoomApi.subscribe(state => {\n      const zoom = state.views[this.props.type].zoomPct;\n      const zppZoom = state.views[this.props.type].zoomZppPct;\n\n      if (\n        (this.state.zoom !== zoom || this.state.zoom !== zppZoom) &&\n        this.props.type === state.last\n      ) {\n        this.setState(prevState => ({\n          zoom: zoom,\n        }));\n      }\n    });\n\n    return (\n      <div className=\"viewer-wrapper\">\n        <Zpp\n          type={this.props.type}\n          img={this.state.image}\n          imageWidth={this.props.imageWidth}\n        />\n        <Zoom type={this.props.type} />\n      </div>\n    );\n  }\n}\n\nexport default withFileStore(Viewer);\n","import React, { useRef, useMemo } from 'react';\nimport { uApi } from '../utils/index.js';\nimport { useFrame } from 'react-three-fiber';\n\nconst fragmentShader = `\n  uniform sampler2D image;\n\n  uniform float brightness;\n  uniform float contrast;\n\n  uniform float blackpoint;\n  uniform float whitepoint;\n  uniform float opacity;\n  uniform vec3 color;\n\n  varying vec2 vUv;\n\n  vec4 setBrightness(in vec4 clr, in float br) {\n    clr.rgb += br;\n    return clr;\n  }\n\n  vec4 setContrast(in vec4 clr, in float ct) {\n    if (ct > 0.0) {\n      clr.rgb = (clr.rgb - 0.5) / (1.0 - ct) + 0.5;\n    } else {\n      clr.rgb = (clr.rgb - 0.5) * (1.0 + ct) + 0.5;\n    }\n    return clr;\n  }\n\n  vec4 setWpBp(in vec4 clr, in float bp, in float wp) {\n    float _blackpoint = bp / 255.0;\n    float _whitepoint = bp == wp ? (255.0 / 0.00025) : (255.0 / (wp - bp));\n    clr.rgb = clr.rgb * _whitepoint - (_whitepoint * _blackpoint);\n    return clr;\n  }\n\n  vec4 setOpacity(in vec3 clr, in float opc) {\n    vec4 _color = vec4(clr, opc);\n    return _color;\n  }\n\n  vec4 sampleColor() {\n    // red with 50% opacity\n    return vec4(1.0, 0.0, 0.0, 0.5);\n  }\n\n  vec4 toGrayscale(in vec4 color)\n  {\n    float average = (color.r + color.g + color.b) / 3.0;\n    return vec4(average, average, average, 1.0);\n  }\n\n  vec4 colorize(in vec4 grayscale, in vec4 color)\n  {\n    return (grayscale * color);\n  }\n\n  vec4 applyColorize(in vec4 color, in vec4 overlay) {\n    vec4 grayscale = toGrayscale(color);\n    vec4 colorizedOutput = colorize(grayscale, overlay);\n    return colorizedOutput;\n  }\n\n  vec4 applyOverlay(in vec4 color, in vec4 overlay) {\n    return (vec4(mix(color.rgb, overlay.rgb, overlay.a), color.a));\n  }\n\n  void main() {\n    vec4 tColor = texture2D(image, vUv);\n    tColor = setBrightness(tColor, brightness);\n    tColor = setContrast(tColor, contrast);\n    tColor = setWpBp(tColor, blackpoint, whitepoint);\n\n    vec4 oColor = setOpacity(color, opacity);\n\n    // tColor = applyColorize(tColor, oColor);\n    tColor = applyOverlay(tColor, oColor);\n    gl_FragColor = tColor;\n  }\n`;\n\nconst vertexShader = `\n  varying vec2 vUv;\n\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }\n`;\n\nfunction Mesh(props) {\n  const ref = useRef();\n  const material = useRef();\n  var uniforms = useMemo(\n    () => uApi.getState().channels[props.channel - 1].uniforms,\n    [props]\n  );\n\n  useFrame(state => {\n    material.current.uniforms.brightness.value = uApi.getState().channels[\n      props.channel - 1\n    ].uniforms.brightness.value;\n    material.current.uniforms.contrast.value = uApi.getState().channels[\n      props.channel - 1\n    ].uniforms.contrast.value;\n    material.current.uniforms.whitepoint.value = uApi.getState().channels[\n      props.channel - 1\n    ].uniforms.whitepoint.value;\n    material.current.uniforms.blackpoint.value = uApi.getState().channels[\n      props.channel - 1\n    ].uniforms.blackpoint.value;\n    material.current.uniforms.opacity.value = uApi.getState().channels[\n      props.channel - 1\n    ].uniforms.opacity.value;\n    material.current.uniforms.image.value = uApi.getState().channels[\n      props.channel - 1\n    ].uniforms.image.value;\n    material.current.uniforms.color.value = uApi.getState().channels[\n      props.channel - 1\n    ].uniforms.color.value;\n  });\n\n  return (\n    <mesh ref={ref} scale={[1.0, 1.0, 1.0]}>\n      <planeBufferGeometry attach=\"geometry\" args={[5.0, 5.0]} />\n      <shaderMaterial\n        attach=\"material\"\n        ref={material}\n        fragmentShader={fragmentShader}\n        vertexShader={vertexShader}\n        uniforms={uniforms}\n      />\n    </mesh>\n  );\n}\n\nexport default Mesh;\n","import React from 'react';\nimport create from 'zustand';\nimport Mesh from './Mesh.js';\nimport { Canvas } from 'react-three-fiber';\n\nexport const meshState = {\n  mesh: [<Mesh channel=\"1\" />, <Mesh channel=\"2\" />, <Mesh channel=\"3\" />, <Mesh channel=\"4\" />],\n};\n\nexport const [useMeshStore, meshApi] = create(set => ({\n  ...meshState,\n}));\n\nexport const canvasState = {\n  canvas: [\n    <Canvas className={'image-canvas-1'}>{meshState.mesh[0]}</Canvas>,\n    <Canvas className={'image-canvas-2'}>{meshState.mesh[1]}</Canvas>,\n    <Canvas className={'image-canvas-3'}>{meshState.mesh[2]}</Canvas>,\n    <Canvas className={'main-image-canvas'}>{meshState.mesh[3]}</Canvas>,\n  ],\n};\n\nexport const [useCanvasStore, canvasApi] = create(set => ({\n  ...canvasState,\n}));\n","import create from 'zustand';\n\nconst initState = {\n  annotations: [],\n};\n\nconst cachedState = {\n  cachedAnnots: [],\n};\n\nexport const [useAnnotStore, annotApi] = create(set => ({\n  ...initState,\n}));\n\nexport const [useCacheStore, cachedAnnotApi] = create(set => ({\n  ...cachedState,\n}));\n","import { annotApi, cachedAnnotApi } from './annotationStore.js';\n\nexport function addAnnotation(group, label, classLabel) {\n  const default_class = 'class1';\n  annotApi.setState(prevState => ({\n    ...prevState,\n    annotations: [\n      ...prevState.annotations,\n      {\n        group: group,\n        label: label,\n        class: classLabel || default_class,\n      },\n    ],\n  }));\n}\n\nexport function addCachedAnnotation(group, label, classLabel) {\n  cachedAnnotApi.setState(prevState => ({\n    ...prevState,\n    cachedAnnots: [\n      ...prevState.cachedAnnots,\n      {\n        group: group,\n        label: label,\n        class: classLabel,\n      },\n    ],\n  }));\n}\n\nexport function deleteAnnotation(index) {\n  annotApi.setState(prevState => {\n    return prevState.annotations.splice(index, 1);\n  });\n}\n\nexport function deleteCachedAnnotation(index) {\n  cachedAnnotApi.setState(prevState => {\n    return prevState.cachedAnnots.splice(index, 1);\n  });\n}\n\nexport function undoAnnotation() {\n  const index = annotApi.getState().annotations.length - 1;\n  const annotation = annotApi.getState().annotations[index];\n  deleteAnnotation(index);\n  addCachedAnnotation(annotation.group, annotation.label, annotation.class);\n}\n\nexport function getLastAnnotIdx() {\n  return annotApi.getState().annotations.length - 1;\n}\n\nexport function getLastCachedAnnot() {\n  return cachedAnnotApi.getState().cachedAnnots[\n    cachedAnnotApi.getState().cachedAnnots.length - 1\n  ];\n}\n\nexport function getLastCachedAnnotIdx() {\n  return cachedAnnotApi.getState().cachedAnnots.length - 1;\n}\n\nexport function updateAnnotationLabel(oldLabel, label) {\n  annotApi.setState(prevState => {\n    const annotations = prevState.annotations.map((annot, j) => {\n      if (annot.label === oldLabel) {\n        var newAnnot = annot;\n        newAnnot.label = label;\n        return newAnnot;\n      } else {\n        return annot;\n      }\n    });\n    return {\n      annotations,\n    };\n  });\n}\n\nexport function updateAnnotClassLabel(oldLabel, label) {\n  annotApi.setState(prevState => {\n    const annotations = prevState.annotations.map((annot, j) => {\n      if (annot.class === oldLabel) {\n        var newAnnot = annot;\n        newAnnot.class = label;\n        return newAnnot;\n      } else {\n        return annot;\n      }\n    });\n    return {\n      annotations,\n    };\n  });\n}\n\nexport function getAnnotationClasses() {\n  var classes = [];\n  const annotations = annotApi.getState().annotations;\n  for (var i = 0; i < annotations.length; i++) {\n    classes.push(annotations[i].class);\n  }\n  return classes;\n}\n","import {setDisplay, getSelectedObjects, updateSelect} from \"./annotationSettings.js\"\nimport {updateLabel, updateClassLabel} from './editControl.js'\n\nexport function editAnnotationOption(label, classLabel) {\n  setDisplay(false);\n  updateSelect(1);\n}\nexport function editClassOption() {\n  setDisplay(false);\n  updateSelect(2);\n}\n\nexport function editAnnotationLabel(label) {\n\n  const obj = getSelectedObjects()\n  if (obj && (obj._objects.length > 0)) {\n    updateLabel(obj, label)\n    updateSelect(0);\n  }\n}\n\nexport function editAnnotationClass(className) {\n  const obj = getSelectedObjects()\n  if (obj && (obj._objects.length > 0)) {\n    updateClassLabel(obj, className)\n    updateSelect(0);\n  }\n}\n","import { fabric } from 'fabric';\nimport {\n  addAnnotation,\n  undoAnnotation,\n  getLastAnnotIdx,\n  getLastCachedAnnot,\n  getLastCachedAnnotIdx,\n  deleteCachedAnnotation,\n  updateAnnotationLabel,\n  updateAnnotClassLabel,\n} from './annotationControl.js';\nimport { getCanvas } from './annotationSettings.js';\nimport { getDisabledClasses } from './annotationClass.js';\n\nexport const colors = [\n  'rgb(221, 153, 153, 0.7)',\n  'rgb(153, 221, 153, 0.7)',\n  'rgb(153, 153, 221, 0.7)',\n  'rgb(215, 215, 215, 0.7)',\n];\n\nexport function drawFreeStyle(canvas) {\n  window.canvas = canvas;\n  canvas.isMouseDown = false;\n\n  canvas.isDrawingMode = true;\n  canvas.freeDrawingBrush.color = colors.purple;\n  canvas.freeDrawingBrush.opacity = 0.1;\n  canvas.freeDrawingBrush.width = 10;\n}\n\nexport function drawRect(canvas, rect, label, classLabel) {\n  var fRect = new fabric.Rect({\n    left: rect.left,\n    top: rect.top,\n    width: rect.width,\n    height: rect.height,\n    // if fully transparent, only stroke is selectable, hence this hack:\n    fill: 'rgb(255,255,255,.01)',\n    stroke: rect.color,\n    strokeLineJoin: 'round',\n    strokeWidth: 2,\n    objectCaching: false,\n  });\n\n  var group = new fabric.Group([fRect]);\n\n  group.on({\n    moving: function(o) {\n      const group = o.target;\n      const rect = group._objects[0];\n\n      if (group.left < 0) {\n        group.set('left', rect.strokeWidth / 2);\n        group.setCoords();\n      } else if (group.left + group.width > canvas.width) {\n        group.set('left', canvas.width - group.width - rect.strokeWidth / 2);\n        group.setCoords();\n      }\n\n      if (group.top < 0) {\n        group.set('top', rect.strokeWidth / 2);\n        group.setCoords();\n      } else if (group.top + group.height > canvas.height) {\n        group.set('top', canvas.height - group.height - rect.strokeWidth / 2);\n        group.setCoords();\n      }\n    },\n  });\n\n  var newLabel = label === 'label' ? (label += getLastAnnotIdx() + 1) : label;\n\n  var text = new fabric.IText(newLabel, {\n    fontSize: 16,\n    originX: 'left',\n    originY: 'top',\n    fontFamily: 'Arial',\n    fontWeight: 'bold',\n    fill: 'white',\n    textBackgroundColor: rect.color,\n    top: group.top,\n    left: group.left,\n  });\n\n  var classText = new fabric.IText(classLabel, {\n    fontSize: 16,\n    originX: 'left',\n    originY: 'bottom',\n    fontFamily: 'Arial',\n    fontWeight: 'bold',\n    fill: 'white',\n    textBackgroundColor: rect.color,\n    top: group.top + group.height,\n    left: group.left,\n  });\n\n  if (canvas) {\n    fRect.perPixelTargetFind = true;\n    canvas.add(group);\n    canvas.setActiveObject(group);\n    group.addWithUpdate(text);\n    group.addWithUpdate(classText);\n    addAnnotation(group, newLabel, classLabel);\n  }\n}\n\nexport function updateLabel(object, label) {\n  var oldLabel = '';\n  if (object && label) {\n    ungroup(object);\n\n    if (object) {\n      var objs = object._objects;\n      if (objs && objs.length > 0) {\n        for (var i = 0; objs.length; i++) {\n          if (objs[i]) {\n            if (i === 1) {\n              if (objs[i].text) {\n                oldLabel = objs[i].text;\n                objs[i].text = label;\n                updateAnnotationLabel(oldLabel, label);\n                getCanvas().renderAll();\n                regroup(object);\n                return;\n              }\n            }\n          } else {\n            return;\n          }\n        }\n      }\n    }\n  }\n}\n\nexport function updateClassLabel(object, label) {\n  var oldLabel = '';\n  if (object && label) {\n    ungroup(object);\n\n    if (object) {\n      var objs = object._objects;\n      if (objs && objs.length > 0) {\n        for (var i = 0; objs.length; i++) {\n          if (objs[i]) {\n            if (i === 2) {\n              if (objs[i].text) {\n                oldLabel = objs[i].text;\n                objs[i].text = label;\n                updateAnnotClassLabel(oldLabel, label);\n                getCanvas().renderAll();\n                regroup(object);\n                return;\n              }\n            }\n          } else {\n            return;\n          }\n        }\n      }\n    }\n  }\n}\n\nexport function ungroup(object) {\n  var canvas = getCanvas();\n  var items = object._objects;\n  if (items.length >= 2) {\n    object._restoreObjectsState();\n    canvas.remove(object);\n    for (var i = 0; i < items.length; i++) {\n      canvas.add(items[i]);\n      canvas.item(canvas.size() - 1).hasControls = true;\n    }\n    canvas.renderAll();\n  }\n}\n\nexport function regroup(object) {\n  if (object && object._objects.length === 3) {\n    var objs = object._objects;\n\n    var rect = objs[0];\n    var label = objs[1];\n    var classLabel = objs[2];\n\n    var group = new fabric.Group([rect, label, classLabel]);\n    var canvas = getCanvas();\n    if (canvas) {\n      canvas.add(group);\n      canvas.remove(rect);\n      canvas.remove(label);\n      canvas.remove(classLabel);\n      canvas.setActiveObject(group);\n    }\n  }\n}\n\nexport function filterClasses(cls) {\n  filterAnnotations(cls.name, cls.enabled);\n}\n\nexport function filterAnnotations(classLabel, enabled) {\n  var canvas = getCanvas();\n  var objs = canvas.getObjects();\n  for (var i = 0; i < objs.length; i++) {\n    var group = objs[i];\n    if (group) {\n      var group_elements = group._objects;\n      if (group_elements) {\n        var class_element = group._objects[2];\n        if (class_element && class_element.text) {\n          if (class_element.text === classLabel) {\n            if (enabled) {\n              markGroupVisible(group);\n            } else {\n              markGroupInvisible(group);\n              canvas.discardActiveObject();\n            }\n          }\n        }\n      }\n    }\n  }\n  canvas.renderAll();\n}\n\nexport function filterDisabledClasses() {\n  const classes = getDisabledClasses();\n  for (var i = 0; i < classes.length; i++) {\n    filterAnnotations(classes[i]);\n  }\n  getCanvas().renderAll();\n}\n\nexport function showAll() {\n  var canvas = getCanvas();\n  var objs = canvas.getObjects();\n  for (var i = 0; i < objs.length; i++) {\n    var group = objs[i];\n    if (group) {\n      markGroupVisible(group);\n    }\n  }\n}\n\nexport function markGroupVisible(group) {\n  ungroup(group);\n\n  var objs = group._objects;\n  for (var i = 0; i < objs.length; i++) {\n    var obj = objs[i];\n    markVisible(obj, true);\n  }\n\n  regroup(group);\n}\n\nexport function markGroupInvisible(group) {\n  ungroup(group);\n\n  var objs = group._objects;\n  for (var i = 0; i < objs.length; i++) {\n    var obj = objs[i];\n    markVisible(obj, false);\n  }\n\n  regroup(group);\n}\n\nfunction markVisible(obj, visible) {\n  obj.visible = visible;\n  obj.dirty = true;\n  getCanvas().renderAll();\n}\n\nexport function undo() {\n  var canvas = getCanvas();\n  const idx = getLastAnnotIdx();\n\n  if (idx >= 0) {\n    // remove from canvas\n    canvas.getObjects().map(function(o, i) {\n      if (i === idx) {\n        canvas.remove(o);\n      }\n      return null;\n    });\n\n    // remove from annotations\n    undoAnnotation();\n  }\n  return null;\n}\n\nexport function redo() {\n  var canvas = getCanvas();\n  const idx = getLastCachedAnnotIdx();\n\n  if (idx >= 0) {\n    // get last from cache\n    const cachedAnnot = getLastCachedAnnot();\n    // redraw on canvas\n    drawRect(canvas, cachedAnnot.group, cachedAnnot.label, cachedAnnot.class);\n    // remove from cache\n    deleteCachedAnnotation(idx);\n  }\n}\n","import create from 'zustand';\nimport {editAnnotationOption, editClassOption} from './annotationMenuOptions.js'\n\nexport const initState = {\n  menu: {\n    displayon: false,\n    coords: {\n      x: 0,\n      y: 0\n    },\n    items: [\n      {\n        \"label\": \"Edit Annotation\",\n        \"callback\": editAnnotationOption\n      },\n      {\n        \"label\": \"Edit Class\",\n        \"callback\": editClassOption\n      }\n    ],\n    objects: [],\n    select: 0,\n    canvas: null\n  }\n}\n\nexport const [useAnnotationMenu, AnnotationMenuApi] = create ( set => ({\n  ...initState,\n}))\n\nexport function isDisplayOn() {\n  return AnnotationMenuApi.getState().menu.displayon\n}\n\nexport function setCanvas(canvas) {\n  AnnotationMenuApi.setState( prevState => ({\n    ...prevState,\n    canvas: canvas\n  }))\n}\n\nexport function getCanvas() {\n  return AnnotationMenuApi.getState().canvas\n}\n\nexport function setDisplay(value) {\n  AnnotationMenuApi.setState( prevState => ({\n    ...prevState,\n    menu: {\n      ...prevState.menu,\n      displayon: value\n    }\n  }))\n}\n\nexport function getMenuCoords() {\n  return AnnotationMenuApi.getState().menu.coords\n}\n\nexport function setMenuCoords(x, y) {\n  AnnotationMenuApi.setState( prevState => ({\n    ...prevState,\n    menu: {\n      ...prevState.menu,\n      coords: {\n        x: x,\n        y: y\n      }\n    }\n  }))\n}\n\nexport function getItems() {\n  return AnnotationMenuApi.getState().menu.items\n}\n\nexport function setSelectedObjects(objects) {\n  AnnotationMenuApi.setState( prevState => ({\n    ...prevState,\n    menu: {\n      ...prevState.menu,\n      objects: objects\n    }\n  }))\n}\n\nexport function getSelectedObjects() {\n  return AnnotationMenuApi.getState().menu.objects\n}\n\nexport function updateSelect(sel) {\n  AnnotationMenuApi.setState( prevState => ({\n    ...prevState,\n    menu: {\n      ...prevState.menu,\n      select: sel\n    }\n  }))\n}\n","import create from 'zustand';\n\nimport { getAnnotationClasses } from './annotationControl.js';\n\nconst initState = {\n  classes: [\n    {\n      \"name\": \"Annotation Class 1\",\n      \"enabled\": false,\n    },\n    {\n      \"name\": \"Annotation Class 2\",\n      \"enabled\": false,\n    },\n    {\n      \"name\": \"Annotation Class 3\",\n      \"enabled\": false,\n    },\n    {\n      \"name\": \"Annotation Class 4\",\n      \"enabled\": false,\n    },\n  ]\n}\n\nfunction addClass(classLabel) {\n  const default_class = 'class1'\n  annotClassApi.setState(prevState => ({\n    ...prevState,\n    classes: [\n      ...prevState.classes,\n      {\n        name: classLabel || default_class,\n        enabled: false\n      },\n    ],\n  }));\n}\n\nexport const [useAnnotClass, annotClassApi] = create ( set => ({\n  ...initState,\n}))\n\nexport function updateClasses() {\n  const classes = getAnnotationClasses()\n  for (var i = 0; i < classes.length;  i++) {\n    const cls = classes[i]\n    if (!isDuplicateClass(cls)) {\n      addClass(cls)\n      enableClass(cls)\n    }\n  }\n}\n\nexport function enableClass(label) {\n  annotClassApi.setState( prevState => {\n    const classes = prevState.classes.map((cls, j) => {\n      if (cls.name === label) {\n        var newCls = cls;\n        newCls.enabled = true\n        return newCls;\n      }\n      else {\n        return cls\n      }\n    })\n    return {\n      classes\n    }\n  })\n}\n\nexport function toggleClassEnable(num) {\n  annotClassApi.setState( prevState => {\n    const classes = prevState.classes.map((cls, j) => {\n      if (j === num) {\n        var newCls = cls;\n        newCls.enabled = !cls.enabled\n        return newCls;\n      }\n      else {\n        return cls\n      }\n    })\n    return {\n      classes\n    }\n  })\n}\n\nexport function isDuplicateClass(name) {\n  const classes = annotClassApi.getState().classes\n  if (classes) {\n    const x = classes.filter(cls => cls.name === name);\n    if (x.length !== 0){\n      return true;\n    }\n  }\n  return false;\n}\n\nexport function getClasses() {\n  return annotClassApi.getState().classes\n}\n\nexport function getDisabledClasses() {\n  var enabledClasses = []\n  const classes = annotClassApi.getState().classes\n  if (classes) {\n    for (var i = 0; i < classes.length; i++) {\n      const cls = classes[i]\n      if (!cls.enabled) {\n        enabledClasses.push(cls.name)\n      }\n    }\n  }\n  return enabledClasses\n}\n","import React from 'react';\nimport { fabric } from 'fabric';\nimport {\n  filterAnnotations,\n  showAll,\n  drawFreeStyle,\n  colors,\n} from '../../annotator/editControl.js';\nimport { annotApi } from '../../annotator/annotationStore.js';\nimport AnnotationMenu from '../../annotator/annotationMenu.js';\nimport {\n  setCanvas,\n  AnnotationMenuApi,\n} from '../../annotator/annotationSettings.js';\nimport {\n  openMenu,\n  startDrawing,\n  startSelecting,\n  finish,\n  addToFabric,\n  setFabricCanvas,\n  setMode,\n  fabricApi,\n  modes,\n} from '../../fabric/fabricControl.js';\n\nvar canvas;\n\nclass FabricLayer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.canvasRef = React.createRef();\n\n    this.handleMouseDown = this.handleMouseDown.bind(this);\n    this.handleMouseUp = this.handleMouseUp.bind(this);\n    this.handleMouseDoubleClick = this.handleMouseDoubleClick.bind(this);\n    this.handleDrag = this.handleDrag.bind(this);\n    this.selectClass1 = this.selectClass1.bind(this);\n    this.showAll = this.showAllClasses.bind(this);\n    this.handleMoveAnnotation = this.handleMoveAnnotation.bind(this);\n    // this.handleResize = this.handleResize.bind(this);\n  }\n\n  componentDidMount() {\n    canvas = new fabric.Canvas(this.canvasRef.current, {\n      fireRightClick: true,\n    });\n    canvas.on({\n      'mouse:down': this.handleMouseDown,\n      'mouse:up': this.handleMouseUp,\n      'mouse:dblclick': this.handleMouseDoubleClick,\n      'object:moving': this.handleMoveAnnotation,\n      'object:rotating': this.handleDrag,\n      'object:scaling': this.handleDrag,\n    });\n    setCanvas(canvas);\n    setFabricCanvas(canvas);\n  }\n\n  handleDrag(e) {\n    startSelecting();\n  }\n\n  handleMoveAnnotation(e) {\n    setMode(modes.SELECT);\n  }\n\n  handleLeftMouseDown(options) {\n    const mode = fabricApi.getState().drawMode;\n    if (mode === modes.RECT) {\n      startDrawing(options.e.clientX, options.e.clientY);\n    } else if (mode === modes.FREE) {\n      drawFreeStyle(canvas);\n    }\n  }\n\n  handleRightMouseDown(options) {\n    openMenu(options.e.clientX, options.e.clientY);\n  }\n\n  handleLeftMouseUp(options) {\n    finish(options.e.clientX, options.e.clientY, colors[this.props.channel]);\n  }\n\n  handleRightMouseUp(options) {}\n\n  handleMouseDown(options) {\n    if (options.button === 3) {\n      this.handleRightMouseDown(options);\n    } else {\n      this.handleLeftMouseDown(options);\n    }\n  }\n\n  handleMouseUp(options) {\n    if (options.button === 3) {\n      this.handleRightMouseUp(options);\n    } else {\n      this.handleLeftMouseUp(options);\n    }\n  }\n\n  handleObjectSelect(e) {\n    // if more than one object is selected\n    // if Delete button is selected\n    // delete all objects from canvas\n    // remove from annotations\n  }\n\n  handleObjectResize(e) {\n    // if an object is selected, and resized\n    // updateRect(rect)\n  }\n\n  handleMouseDoubleClick(e) {\n    // if an object is selected\n    // updateLabel (label)\n    startSelecting();\n  }\n\n  displayMenu() {\n    if (canvas && canvas.getActiveObjects().length > 0) {\n      return <AnnotationMenu />;\n    }\n  }\n  selectClass1() {\n    filterAnnotations('class1');\n    this.forceUpdate();\n  }\n  showAllClasses() {\n    showAll();\n    this.forceUpdate();\n  }\n\n  render() {\n    annotApi.subscribe(state => {\n      if (state) {\n        addToFabric();\n      }\n    });\n    AnnotationMenuApi.subscribe(state => {\n      this.forceUpdate();\n    });\n\n    return (\n      <div\n        className=\"annotationLayer\"\n        onContextMenu={e => e.preventDefault()}\n        style={{\n          borderColor: colors[this.props.channel],\n          borderWidth: 2,\n          borderStyle: 'solid',\n          opacity: this.props.opacity,\n          zIndex: this.props.zIndex,\n        }}\n      >\n        <canvas ref={this.canvasRef} width={500} height={500} />\n        {this.displayMenu()}\n      </div>\n    );\n  }\n}\n\nexport default FabricLayer;\n","import React from \"react\";\nimport {editAnnotationLabel, editAnnotationClass} from './annotationMenuOptions.js'\n\nclass AnnotationSubMenu extends React.Component {\n constructor(props) {\n   super(props);\n    this.handleChange = this.handleChange.bind(this);\n    this.changeLabel = this.changeLabel.bind(this);\n    this.changeClassLabel = this.changeClassLabel.bind(this);\n\n    this.state = {\n      text: {\n        style: {\n         'position': 'absolute',\n         'top': '0px',\n         'left':'0px'\n        },\n      },\n      label: {\n        text: \"\",\n        style: {\n         'position': 'absolute',\n         'top': '0px',\n         'left':'0px'\n        },\n      },\n      button: {\n        style: {\n         'position': 'absolute',\n         'top': '0px',\n         'left':'0px'\n        },\n      },\n    };\n  }\n\n  componentDidMount() {\n    var labelTop = (parseInt(this.props.style.top.match(/\\d+/g)) - 40) +'px'\n    var buttonLeft = (parseInt(this.props.style.left.match(/\\d+/g)) + 105) +'px'\n\n    this.setState({\n      text: {\n        style: {\n           'position': this.props.style.position,\n           'top': this.props.style.top,\n           'left': this.props.style.left,\n           'width': '100px'\n        }\n      },\n      label: {\n        style: {\n           'position': this.props.style.position,\n           'top': labelTop,\n           'left': this.props.style.left,\n           'width': '100px'\n        },\n        text: ''\n      },\n      button: {\n        style: {\n           'position': this.props.style.position,\n           'top': this.props.style.top,\n           'left': buttonLeft\n        }\n      }\n    })\n  }\n\n  handleChange(event) {\n    if (event && event.target && event.target.value) {\n      var newStr = event.target.value\n      this.setState( prevState => ({\n        ...prevState,\n        label: {\n          ...prevState.label,\n          text: newStr\n        }\n      }))\n    }\n  }\n\n  changeLabel(event) {\n    editAnnotationLabel(this.state.label.text)\n  }\n\n  changeClassLabel(event) {\n    editAnnotationClass(this.state.label.text)\n  }\n\n  display() {\n    if (this.props.select === 1) {\n      return (\n        <div >\n          <div style={this.state.label.style}> <p> Label: </p> </div>\n          <input\n            type=\"text\"\n            value={this.state.label.text}\n            style={this.state.text.style}\n            onChange={this.handleChange}\n          />\n          <button style={this.state.button.style} onClick={this.changeLabel}> Change Label </button>\n        </div>\n      );\n    }\n    else if (this.props.select === 2) {\n      return (\n        <div >\n          <div style={this.state.label.style}> <p> Class Name: </p> </div>\n          <input\n            type=\"text\"\n            value={this.state.label.text}\n            style={this.state.text.style}\n            onChange={this.handleChange}\n          />\n          <button style={this.state.button.style} onClick={this.changeClassLabel}> Change Class Name </button>\n        </div>\n      );\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        {this.display()}\n      </div>\n    )\n  }\n}\n\nexport default AnnotationSubMenu;","import React from \"react\";\nimport { getItems, AnnotationMenuApi} from \"./annotationSettings.js\"\nimport AnnotationSubMenu from './annotationSubMenu.js'\n\nclass AnnotationMenu extends React.Component {\n constructor(props) {\n   super(props);\n\n    this.contextRef = React.createRef();\n    this.returnMenu = this.returnMenu.bind(this);\n\n    this.state = {\n      items: [],\n      coords: {\n        x: 0,\n        y: 0\n      },\n      style: {\n       'position': 'absolute',\n       'top': '0px',\n       'left':'0px'\n      },\n      on: false,\n      select: 0,\n    };\n  }\n\n  updateCoords(x, y) {\n    if (this.state.coords.x !== x\n      && this.state.coords.y !== y) {\n      this.setState( prevState => ({\n        ...prevState,\n        coords: {\n          x: x,\n          y: y,\n        },\n        style: {\n          ...prevState.style,\n          'top': `${y}px`,\n          'left':`${x+5}px`\n        }\n      }))\n    }\n  }\n\n  updateItems(items) {\n    if (this.state.items !== items) {\n      this.setState( prevState => ({\n        ...prevState,\n        items: items\n      }))\n    }\n  }\n\n  updateDisplay(on) {\n    if (this.state.on !== on) {\n      this.setState( prevState => ({\n        ...prevState,\n        on: on\n      }))\n    }\n  }\n  updateSelect(sel) {\n    if (this.state.select !== sel) {\n      this.setState( prevState => ({\n        ...prevState,\n        select: sel\n      }))\n    }\n  }\n\n  returnMenu() {\n    AnnotationMenuApi.subscribe(state => {\n      this.updateItems(state.menu.items)\n      this.updateCoords(state.menu.coords.x, state.menu.coords.y)\n      this.updateDisplay(state.menu.displayon)\n      this.updateSelect(state.menu.select)\n    })\n    if (this.state.on) {\n      return (\n        <div className='custom-context' id='customcontext' style={this.state.style} ref={this.contextRef}>\n        {\n          getItems().map((item, index, arr) => {\n            if (arr.length > 0) {\n              let label = item.label+\"-button-wrapper\"\n              return (\n                <div key={label}>\n                  <button onClick={item.callback}> {item.label} </button>\n                </div>\n              )\n            }\n            return null\n          })\n        }\n        </div>\n      )\n    }\n\n    if (this.state.select === 1 || this.state.select === 2) {\n      return (\n        <AnnotationSubMenu style={this.state.style} select={this.state.select}/>\n      )\n    }\n    return (\n      null\n    )\n  }\n\n  render() {\n    return (\n      <div id='cmenu'>\n        {this.returnMenu()}\n      </div>\n    );\n  }\n}\n\nexport default AnnotationMenu;","import create from 'zustand';\n\nimport { drawRect, drawFreeStyle } from '../annotator/editControl.js';\nimport {\n  isDisplayOn,\n  setDisplay,\n  setMenuCoords,\n  setSelectedObjects,\n} from '../annotator/annotationSettings.js';\n\nexport const modes = {\n  RECT: 'rectangle',\n  FREE: 'free draw',\n  SELECT: 'select',\n  NONE: 'none',\n};\n\nconst initState = {\n  mouse: {\n    x: 0,\n    y: 0,\n    down: false,\n  },\n  origin: {\n    x: 0,\n    y: 0,\n  },\n  drawMode: modes.RECT,\n  canvas: null,\n};\n\nexport const [useFabric, fabricApi] = create(set => ({\n  ...initState,\n}));\n\nexport function setFabricCanvas(canvas) {\n  fabricApi.setState(prevState => ({\n    canvas: canvas,\n  }));\n}\n\nexport function setMode(newMode) {\n  fabricApi.setState(prevState => ({\n    ...prevState,\n    drawMode: newMode,\n  }));\n\n  if (newMode === modes.FREE) {\n    fabricApi.getState().canvas.isDrawingMode = true;\n  } else {\n    fabricApi.getState().canvas.isDrawingMode = false;\n  }\n}\n\nexport function startSelecting() {\n  setMode(modes.SELECT);\n}\n\nexport function finishSelecting() {\n  setMode(modes.RECT);\n}\n\nexport function startDrawing(x, y) {\n  if (fabricApi.getState().canvas.isDrawingMode) {\n    startDrawingFree(x, y);\n  } else {\n    startDrawingRect(x, y);\n  }\n}\n\nexport function startDrawingFree(x, y) {\n  drawFreeStyle(fabricApi.getState().canvas);\n}\n\nexport function finish(x, y, color) {\n  if (fabricApi.getState().drawMode === modes.SELECT) {\n    finishSelecting();\n  } else if (fabricApi.getState().drawMode === modes.RECT) {\n    finishDrawingRect(x, y, color);\n  }\n}\n\nexport function startDrawingRect(x, y) {\n  setOrigin(x, y);\n}\n\nexport function finishDrawing(x, y) {\n  if (fabricApi.getState().drawMode === modes.RECT) {\n    finishDrawingRect(x, y);\n  }\n  setFabricCoords(x, y);\n}\n\nexport function finishDrawingRect(x, y, color) {\n  setFabricCoords(x, y);\n  const state = fabricApi.getState();\n  if (state.origin.x && state.origin.y && x && y) {\n    const width = state.mouse.x - state.origin.x;\n    if (Math.abs(width) >= 10) {\n      const rect = {\n        width: width,\n        height: state.mouse.y - state.origin.y,\n        top: state.origin.y,\n        left: state.origin.x,\n        color: color,\n      };\n      drawRect(fabricApi.getState().canvas, rect, 'label', 'class1');\n    }\n\n    setSelectedObjects(fabricApi.getState().canvas.getActiveObjects()[0]);\n  }\n}\n\nexport function setOrigin(x, y) {\n  fabricApi.setState(prevState => ({\n    ...prevState,\n    origin: {\n      x: x - fabricApi.getState().canvas._offset.left,\n      y: y - fabricApi.getState().canvas._offset.top,\n    },\n  }));\n}\n\nexport function setFabricCoords(x, y) {\n  let canvasLeft = fabricApi.getState().canvas._offset.left;\n  let canvasRight =\n    fabricApi.getState().canvas._offset.left +\n    fabricApi.getState().canvas.width;\n  let canvasTop = fabricApi.getState().canvas._offset.top;\n  let canvasBottom =\n    fabricApi.getState().canvas._offset.top +\n    fabricApi.getState().canvas.height;\n  let relX =\n    x < canvasLeft\n      ? canvasLeft\n      : x > canvasRight\n      ? canvasRight\n      : x - canvasLeft;\n  let relY =\n    y < canvasTop ? canvasTop : y > canvasBottom ? canvasBottom : y - canvasTop;\n\n  fabricApi.setState(prevState => ({\n    mouse: {\n      x: relX,\n      y: relY,\n    },\n  }));\n}\n\nexport function openMenu(x, y) {\n  if (!isDisplayOn()) {\n    setDisplay(true);\n    let canvas = fabricApi.getState().canvas;\n    setMenuCoords(x - canvas._offset.left, y - canvas._offset.top);\n  }\n}\n\nexport function addToFabric() {\n  let annots = fabricApi.getState().annotations;\n\n  if (annots.length > fabricApi.getState().canvas.getObjects().length) {\n    let lastAnnotIdx = annots.length - 1;\n    let annot = annots[lastAnnotIdx];\n\n    var newAnnot = {\n      left: parseInt(annot.rect.left),\n      top: parseInt(annot.rect.top),\n      width: parseInt(annot.rect.width),\n      height: parseInt(annot.rect.height),\n    };\n\n    drawRect(fabricApi.getState().canvas, newAnnot, annot.label, annot.class);\n  }\n}\n","\nexport class Volume {\n  constructor (args) {\n    this.channel = args.channel; // a data cube\n    this.segmentation = args.segmentation; // a segmentation cube\n\n    this.segments = {};\n    this.requests = [];\n  }\n\n  async renderChannelSlice (ctx, axis, slice) {\n    let _this = this;\n\n    let pixels = await _this.channel.grayImageSlice(axis, slice, /*transparency=*/false, /*copy=*/false);\n    // let pixels = _this.channel.imageSlice(axis, slice, /*copy=*/false);\n    let slice32 = await new Uint32Array(pixels.data.buffer); // creates a view, not an array\n\n    for (let i = slice32.length - 1; i >= 0; i--) {\n      slice32[i] = ((slice32[i] & 0x00ffff00) && slice32[i]);\n    }\n\n    await ctx.putImageData(pixels, 0, 0);\n    return this;\n  }\n  async load (buffer, width, slice) {\n    await this.loadVolume(this.channel, buffer, width, slice)\n  }\n  async loadVolume (cube, buffer, width, slice) {\n    await cube.insertImageData(buffer, width, 0, 0, slice)\n  }\n}","import React, { Component } from \"react\";\nimport create from 'zustand';\nimport {\n  Progress\n} from 'reactstrap';\n\nconst state = {\n  loaded: 0\n}\nconst [useState, stateApi] = create (set => ({\n  ...state\n}))\n\nexport async function loadSlices(cntxt, volume, axes, axis, files, type) {\n  if (type === 1) {\n    await _loadSlicesFromMultipageFile(cntxt, volume, axes, axis, files[0])\n  }\n  else {\n    _loadSlicesFromMultipleFiles(cntxt, volume, axes, axis, files)\n  }\n}\n\nexport async function updateChannelSlice(cntxt, volume, slice, axes, axis) {\n  if (cntxt && volume && axes) {\n    await volume.renderChannelSlice(cntxt, axes[axis], slice)\n  }\n}\n\nasync function _loadVolumes(volume, pages, width) {\n  for (var pIdx = 0; pIdx < pages.length; pIdx++) {\n    const page = pages[pIdx]\n\n    const pct = Math.round((pIdx/pages.length)*100)\n    if ((pct % 10) === 0) {\n      stateApi.setState({\n        loaded: pct\n      })\n    }\n\n    console.log(\"loading \", pIdx , \"/\", pages.length)\n    await volume.load(page, width, pIdx)\n  }\n}\n\nasync function _loadSlicesFromMultipageFile(cntxt, volume, axes, axis, file) {\n  if (file && (file.pages) && (file.pages.length > 0)) {\n    await _loadVolumes(volume, file.pages, file.image.width)\n  }\n\n  updateChannelSlice(cntxt, volume, 0, axes, axis);\n}\n\nfunction _loadSlicesFromMultipleFiles(cntxt, volume, axes, axis, files) {\n  for (var fIdx = 0; fIdx < files.length; fIdx++) {\n    const file = files[fIdx]\n    if (file && (file.pages) && (file.pages.length > 0)) {\n      const pages = file.pages\n      for (var pIdx = 0; pIdx < pages.length; pIdx++) {\n        const page = pages[pIdx]\n        volume.load(this.state.cntxt, page, file.image.width, fIdx)\n      }\n      updateChannelSlice(cntxt, volume, 0, axes, axis);\n    }\n  }\n}\n\nclass ProgressBar extends Component {\n\n  state = {\n    loaded: 0\n  }\n\n  display() {\n    if (this.state.loaded !== 100) {\n      return (\n        <Progress striped bar value={this.state.loaded}> {this.state.loaded}% </Progress>\n      )\n    }\n    else {\n      return (\n        <div> </div>\n      )\n    }\n  }\n\n  render() {\n    stateApi.subscribe(state => {\n      this.state.loaded = state.loaded\n    })\n    return (\n      this.display()\n    )\n  }\n}\n\nexport default ProgressBar;\n","\nclass CachedImageData {\n    constructor (context) {\n        this.context = context;\n        this.cache = null;\n    }\n\n    getImageData(width, height) {\n        if (!this.cache || this.cache.width !== width || this.cache.height !== height) {\n            this.cache = this.context.createImageData(width, height);\n        }\n\n        return this.cache;\n    }\n}\n\nexport default CachedImageData","\nimport CachedImageData from './cachedImageData.js'\n\nclass DataCube {\n  constructor (args) {\n    this.bytes = args.bytes || 1;\n    this.size = args.size || { x: 256, y: 256, z: 256 };\n    this.canvas_context = args.context;\n    this.cube = this.materialize();\n\n    // this.canvas_context = this.createImageContext();\n    this.cached_imgdata = new CachedImageData(this.canvas_context);\n    this.clean = true;\n    this.loaded = false;\n\n    this.faces = {\n      x: [ 'y', 'z' ],\n      y: [ 'x', 'z' ],\n      z: [ 'x', 'y' ],\n    };\n  }\n\n  faceDimensions (axis) {\n    let face = this.faces[axis];\n    return [\n      this.size[face[0]],\n      this.size[face[1]]\n    ];\n  }\n\n  materialize () {\n    let ArrayType = this.arrayType();\n\n    let size = this.size;\n\n    return new ArrayType(size.x * size.y * size.z);\n  }\n\n  insertImageData (imgdata, width, offsetx, offsety, offsetz) {\n    let _this = this;\n\n    // let pixels = imgdata.data; // Uint8ClampedArray\n    let pixels = imgdata;\n\n    // This viewing of the Uint8 as a Uint32 allows for\n    // a memory stride of 4x larger, making reading and writing cheaper\n    // as RAM is the slow thing here.\n    let data32 = new Uint32Array(pixels.buffer); // creates a view, not an array\n\n    // Note: on little endian machine, data32 is 0xaabbggrr, so it's already flipped\n    // from the Uint8 RGBA\n\n    let masks = {\n      true: {\n        1: 0x000000ff,\n        2: 0x0000ffff,\n        4: 0xffffffff,\n      },\n      false: {\n        1: 0xff000000,\n        2: 0xffff0000,\n        4: 0xffffffff,\n      },\n    };\n\n    const mask = masks[this.isLittleEndian()][this.bytes];\n\n    let x = 0, y = 0;\n\n    const sizex = _this.size.x | 0,\n        zadj = (offsetz * _this.size.x * _this.size.y) | 0;\n\n    for (y = width - 1; y >= 0; y--) {\n      for (x = width - 1; x >= 0; x--) {\n\n        _this.cube[\n          (offsetx + x) + sizex * (offsety + y) + zadj\n        ] = data32[ x + y * width ] & mask;\n      }\n    }\n\n    _this.clean = false;\n\n    return this;\n  }\n\n  slice (axis, index, copy = true) {\n    let _this = this;\n\n    if (index < 0 || index >= this.size[axis]) {\n      throw new Error(index + ' is out of bounds.');\n    }\n\n    const xsize = _this.size.x,\n      ysize = _this.size.y,\n      zsize = _this.size.z;\n\n    const xysize = xsize * ysize;\n\n    let face = this.faces[axis];\n    let ArrayType = this.arrayType();\n\n    if (axis === 'z') {\n      let byteoffset = index * xysize * this.bytes;\n\n      if (copy) {\n        let buf = _this.cube.buffer.slice(byteoffset, byteoffset + xysize * this.bytes);\n        return new ArrayType(buf);\n      }\n      else {\n        return new ArrayType(_this.cube.buffer, byteoffset, xysize);\n      }\n    }\n\n    let square = new ArrayType(this.size[face[0]] * this.size[face[1]]);\n\n    // Note: order of loops is important for efficient memory access\n    // and correct orientation of images. Consecutive x access is most efficient.\n\n    let i = square.length - 1;\n    if (axis === 'x') {\n      for (let z = zsize - 1; z >= 0; --z) {\n        for (let y = ysize - 1; y >= 0; --y) {\n          square[i] = _this.cube[index + xsize * y + xysize * z];\n          --i;\n        }\n      }\n    }\n    else if (axis === 'y') {\n      // possible to make this more efficient with an array memcpy\n      // as 256 x are consecutive, but no memcpy in browser.\n      const yoffset = xsize * index;\n      for (let z = zsize - 1; z >= 0; --z) {\n        for (let x = xsize - 1; x >= 0; --x) {\n          square[i] = _this.cube[x + yoffset + xysize * z];\n          --i;\n        }\n      }\n    }\n\n    return square;\n  }\n\n  async grayImageSlice (axis, index, transparency=false, copy=true) {\n\n    let square = await this.slice(axis, index, /*copy=*/false);\n\n    let sizes = await this.faceDimensions(axis);\n\n    let imgdata = copy\n      ? await this.canvas_context.createImageData(sizes[0], sizes[1])\n      : await this.cached_imgdata.getImageData(sizes[0], sizes[1]);\n\n    let data32 = new Uint32Array(imgdata.data.buffer);\n\n    const alpha = this.isLittleEndian()\n      ? 0xff000000\n      : 0x000000ff;\n\n    let i = 0;\n\n    if (transparency) {\n      for (i = square.length - 1; i >= 0; i--) {\n        data32[i] = (square[i] | (square[i] << 8) | (square[i] << 16) | (square[i] && alpha));\n      }\n    }\n    else {\n      for (i = square.length - 1; i >= 0; i--) {\n        data32[i] = (square[i] | (square[i] << 8) | (square[i] << 16) | alpha);\n      }\n    }\n\n    return imgdata;\n  }\n\n  // http://stackoverflow.com/questions/504030/javascript-endian-encoding\n  isLittleEndian () {\n    var arr32 = new Uint32Array(1);\n    var arr8 = new Uint8Array(arr32.buffer);\n    arr32[0] = 255;\n\n    let islittle = (arr8[0] === 255);\n\n    this.isLittleEndian = () => islittle;\n\n    return islittle;\n  }\n\n  // For internal use, return the right bitmask for rgba image slicing\n  // depending on CPU endianess.\n  getRenderMaskSet () {\n    let bitmasks = {\n      true: { // little endian, most architectures\n        r: 0x000000ff,\n        g: 0x0000ff00,\n        b: 0x00ff0000,\n        a: 0xff000000,\n      },\n      false: { // big endian, mostly ARM and some specialized equipment\n        r: 0xff000000,\n        g: 0x00ff0000,\n        b: 0x0000ff00,\n        a: 0x000000ff,\n      },\n    };\n\n    return bitmasks[this.isLittleEndian()];\n  }\n  arrayType () {\n    let choices = {\n      1: Uint8ClampedArray,\n      2: Uint16Array,\n      4: Uint32Array,\n    };\n\n    let ArrayType = choices[this.bytes];\n\n    if (ArrayType === undefined) {\n      throw new Error(this.bytes + ' is not a valid typed array byte count.');\n    }\n\n    return ArrayType;\n  }\n}\n\nexport default DataCube","import React, { Component } from \"react\";\nimport { fApi } from '../../utils/index.js'\nimport {Volume} from '../../datacube/volume.js'\nimport ProgressBar, {\n  loadSlices,\n} from  '../../datacube/datacubeControls.js'\nimport DataCube from '../../datacube/datacube.js'\n\nclass mainTiffViewer extends Component {\n  constructor(props) {\n    super(props);\n\n    this.canvas = React.createRef();\n    this.state = {\n      axes: ['x', 'y', 'z'],\n      axisIdx: props.axis,\n      sliceIdx: 0,\n      cntxt: null,\n    }\n    this.fileLength = 0\n    this.length = 0\n\n    // 0: multifile\n    // 1: multipage\n    this.type = 1\n\n    this.cube = {\n      x: 256,\n      y: 256,\n      z: 256\n    }\n  }\n\n  componentDidMount() {\n    this.setState(prevState => ({\n      cntxt: this.canvas.current.getContext(\"2d\")\n    }))\n  }\n\n  async updateForFile(state) {\n    if (state && state.file) {\n      const idx = state.file.length - 1\n\n      if ((state.file.length > 0) && (state.file[idx].pages) && (state.file[idx].pages.length > 0) && (state.file.length !== this.fileLength)) {\n\n        if (this.type === 0) {\n          this.fileLength = this.length = state.file.length\n        }\n        else if (this.type === 1) {\n          this.fileLength = state.file.length\n          this.length = state.file[idx].pages.length\n        }\n\n        this.cube.x = this.cube.y = this.cube.z = (Math.max(256, this.length))\n\n        this.volume = new Volume({\n          channel: new DataCube({\n            bytes: 1,\n            size: this.cube,\n            context: this.state.cntxt\n          }),\n        });\n\n        await loadSlices(this.state.cntxt, this.volume, this.state.axes, 2, state.file, this.type)\n      }\n    }\n    this.forceUpdate();\n  }\n\n  clamp(val, min, max) {\n    return Math.min(Math.max(val, min), max);\n  }\n\n  render() {\n    fApi.subscribe(state =>  {\n      this.updateForFile(state);\n    })\n    return (\n      <div width=\"500px\" height=\"500px\">\n        <canvas id=\"canvas-1\" ref={this.canvas}\n          width=\"500px\"\n          height=\"500px\"\n        >\n        </canvas>\n        <ProgressBar />\n      </div>\n    )\n  }\n}\n\nexport default mainTiffViewer;","import React from 'react';\n\nimport {\n  cardStyle,\n  card,\n  mainImg,\n  mainCanvasStyle,\n  canvasStyle1,\n  canvasStyle2,\n  canvasStyle3,\n} from '../style.js';\nimport Viewer from '../../viewer/index.js';\nimport { Card, CardTitle, CardBody } from 'reactstrap';\nimport { canvasApi } from '../../imagecanvas/canvasStore.js';\nimport { settingsApi } from '../../mainSettings.js';\nimport FabricLayer from './FabricLayer.js';\nimport MainTiffViewer from './mainTiffViewer.js';\n\nclass mainViewer extends React.Component {\n  altView() {\n    return (\n      <Card style={card}>\n        <CardBody>\n          <CardTitle> Image View </CardTitle>\n          <Viewer imageWidth={mainImg.width} type=\"0\" />\n        </CardBody>\n        <br></br>\n      </Card>\n    );\n  }\n  canvasView() {\n    var canvas = (\n      <MainTiffViewer\n        axis=\"2\"\n        className=\"annot-view\"\n        alt=\"main-canvas\"\n        width=\"500px\"\n        height=\"500px\"\n        channel=\"4\"\n      />\n    );\n    return (\n      <Card style={card}>\n        <CardBody>\n          <CardTitle> Image View </CardTitle>\n          <div id=\"canvasContainer\">\n            <div id=\"main-canvas-view\" style={mainCanvasStyle}>\n              {canvas}\n            </div>\n            <FabricLayer zIndex={5} channel={3} />\n          </div>\n        </CardBody>\n        <br></br>\n      </Card>\n    );\n  }\n\n  channelViews() {\n    var view1;\n    var view2;\n    var view3;\n\n    var fabricCanvas1;\n    var fabricCanvas2;\n    var fabricCanvas3;\n    var canvasZIndex;\n    var opacity;\n\n    var lastSelected = settingsApi.getState().lastSelected;\n    if (settingsApi.getState().channels[0].selected) {\n      console.log('displaying 1');\n      view1 = canvasApi.getState().canvas[0];\n      canvasZIndex = lastSelected === '1' ? 10 : 4;\n      opacity = lastSelected === '1' ? 1 : 0.5;\n      fabricCanvas1 = (\n        <FabricLayer zIndex={canvasZIndex} opacity={opacity} channel={0} />\n      );\n    }\n    if (settingsApi.getState().channels[1].selected) {\n      console.log('displaying 2');\n      view2 = canvasApi.getState().canvas[1];\n      canvasZIndex = lastSelected === '2' ? 10 : 6;\n      opacity = lastSelected === '2' ? 1 : 0.5;\n      fabricCanvas2 = (\n        <FabricLayer zIndex={canvasZIndex} opacity={opacity} channel={1} />\n      );\n    }\n    if (settingsApi.getState().channels[2].selected) {\n      console.log('displaying 3');\n      view3 = canvasApi.getState().canvas[2];\n      canvasZIndex = lastSelected === '3' ? 10 : 8;\n      opacity = lastSelected === '3' ? 1 : 0.5;\n\n      fabricCanvas3 = (\n        <FabricLayer zIndex={canvasZIndex} opacity={opacity} channel={2} />\n      );\n    }\n    return (\n      <Card style={card}>\n        <CardBody>\n          <CardTitle> Image View </CardTitle>\n          <div id=\"canvasContainer\">\n            <div style={canvasStyle1}>{view1}</div>\n            {fabricCanvas1}\n            <div style={canvasStyle2}>{view2}</div>\n            {fabricCanvas2}\n            <div style={canvasStyle3}>{view3} </div>\n            {fabricCanvas3}\n          </div>\n        </CardBody>\n        <br></br>\n      </Card>\n    );\n  }\n\n  display() {\n    if (\n      !settingsApi.getState().channels[0].selected &&\n      !settingsApi.getState().channels[1].selected &&\n      !settingsApi.getState().channels[2].selected\n    ) {\n      return this.canvasView();\n    } else {\n      return this.channelViews();\n    }\n  }\n\n  render() {\n    settingsApi.subscribe(state => {\n      this.forceUpdate();\n    });\n    return (\n      <div className=\"main-view\" style={cardStyle}>\n        {this.display()}\n        {/* <FabricLayer /> */}\n      </div>\n    );\n  }\n}\n\nexport default mainViewer;\n","import React, { Component } from \"react\";\nimport { fApi } from '../../utils/index.js'\nimport {Volume} from '../../datacube/volume.js'\nimport ProgressBar, {\n  loadSlices,\n  updateChannelSlice,\n} from  '../../datacube/datacubeControls.js'\nimport DataCube from '../../datacube/datacube.js'\nimport Slider from './slider.js';\n\nclass TiffViewer extends Component {\n  constructor(props) {\n    super(props);\n\n    this.canvas = React.createRef();\n    this.state = {\n      axes: ['x', 'y', 'z'],\n      axisIdx: props.axis,\n      sliceIdx: 0,\n      cntxt: null,\n    }\n    this.fileLength = 0\n    this.length = 0\n\n    // 0: multifile\n    // 1: multipage\n    this.type = 1\n\n    this.cube = {\n      x: 256,\n      y: 256,\n      z: 256\n    }\n  }\n\n  componentDidMount() {\n    this.setState(prevState => ({\n      cntxt: this.canvas.current.getContext(\"2d\")\n    }))\n  }\n\n  async updateForFile(state) {\n    if (state && state.file) {\n      const idx = state.file.length - 1\n\n      if ((state.file.length > 0) && (state.file[idx].pages) && (state.file[idx].pages.length > 0) && (state.file.length !== this.fileLength)) {\n\n        if (this.type === 0) {\n          this.fileLength = this.length = state.file.length\n        }\n        else if (this.type === 1) {\n          this.fileLength = state.file.length\n          this.length = state.file[idx].pages.length\n        }\n\n        this.cube.x = this.cube.y = this.cube.z = (Math.max(256, this.length))\n\n        this.volume = new Volume({\n          channel: new DataCube({\n            bytes: 1,\n            size: this.cube,\n            context: this.state.cntxt\n          }),\n        });\n\n        await loadSlices(this.state.cntxt, this.volume, this.state.axes, this.state.axisIdx, state.file, this.type)\n      }\n    }\n    this.forceUpdate();\n  }\n\n  slice(value) {\n    this.setState( prevState => ({\n      ...prevState,\n      sliceIdx: value\n    }));\n    updateChannelSlice(this.state.cntxt, this.volume, value, this.state.axes, this.state.axisIdx);\n    this.forceUpdate()\n  }\n\n  nextSlice(dec) {\n    var slice\n    if (dec) slice = (this.clamp(this.state.sliceIdx - 1, 0, Math.max(0, this.length-1)))\n    else slice = (this.clamp(this.state.sliceIdx + 1, 0, Math.max(0, this.length-1)))\n    this.slice(slice)\n  }\n\n  sliderValueSlice(value) {\n    this.slice(value)\n  }\n\n  nextAxis(dec) {\n    var idx\n    if (dec) idx = (this.state.axisIdx + 2) % this.state.axes.length\n    else idx = (this.state.axisIdx + 1) % this.state.axes.length\n\n    this.setState( prevState => ({\n      ...prevState,\n      axisIdx: idx\n    }));\n    updateChannelSlice(this.state.cntxt, this.volume, this.state.sliceIdx, this.state.axes, idx);\n    this.forceUpdate()\n  }\n\n  clamp(val, min, max) {\n    return Math.min(Math.max(val, min), max);\n  }\n\n  render() {\n    fApi.subscribe(state =>  {\n      this.updateForFile(state);\n    })\n    return (\n      <div>\n        <canvas id=\"canvas-1\" ref={this.canvas}\n          width=\"100%\"\n          height=\"100%\"\n        >\n        </canvas>\n        <ProgressBar />\n        <div className=\"slice-slider-container\">\n          <Slider\n            label=\"\"\n            width=\"40%\"\n            min=\"0\"\n            max={Math.max(this.length-1, 0)}\n            step=\"1\"\n            initial=\"0\"\n            multiplier=\"1\"\n            raw=\"1\"\n            sliderValue={this.sliderValueSlice.bind(this)}\n          />\n          <button\n            id=\"resetSliceBtn\"\n            onClick={() => {\n              this.nextSlice(true);\n            }}\n          >\n            {\"<<\"}\n          </button>\n          <button\n            id=\"resetSliceBtn\"\n            onClick={() => {\n              this.slice(0);\n            }}\n          >\n            Go to Slice 0\n          </button>\n          <button\n            id=\"resetSliceBtn\"\n            onClick={() => {\n              this.nextSlice(false);\n            }}\n          >\n            {\">>\"}\n          </button>\n          <div> Slice: {this.state.sliceIdx} </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default TiffViewer;","import React from 'react';\n\nimport { cardStyle, card } from '../style.js';\nimport { Card, CardTitle, CardBody } from 'reactstrap';\nimport AxisTiffViewer from './axisTiffViewer.js';\n\nclass AxesViewer extends React.Component {\n\n  view1 = <AxisTiffViewer axis=\"2\"/>\n  view2 = <AxisTiffViewer axis=\"0\"/>\n  view3 = <AxisTiffViewer axis=\"1\"/>\n\n  render() {\n    return (\n      <div>\n        <div className=\"card-axis-xy\" style={cardStyle}>\n          <Card style={card}>\n            <CardBody>\n              <CardTitle> Axis XY </CardTitle>\n              {this.view1}\n            </CardBody>\n          </Card>\n        </div>\n\n        <br></br>\n        <div className=\"card-axis-yz\" style={cardStyle}>\n          <Card style={card}>\n            <CardBody>\n              <CardTitle> Axis YZ </CardTitle>\n              {this.view2}\n            </CardBody>\n          </Card>\n        </div>\n\n        <br></br>\n        <div className=\"card-axis-xz\" style={cardStyle}>\n          <Card style={card}>\n            <CardBody>\n              <CardTitle> Axis XZ </CardTitle>\n              {this.view3}\n            </CardBody>\n          </Card>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default AxesViewer;\n","import React from 'react';\n\nimport { cardStyle, card } from '../style.js';\nimport './../styles.css';\nimport '../../utils/styles.css';\nimport { updateClasses, getClasses, toggleClassEnable, annotClassApi } from '../../annotator/annotationClass.js'\n\nimport { Button, Card, CardTitle, CardBody } from 'reactstrap';\nimport { annotApi } from '../../annotator/annotationStore.js';\nimport { filterClasses } from '../../annotator/editControl.js'\n\nclass AnnotatorViewer extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      classes: [],\n      annotClasses: [],\n      enables: []\n    }\n  }\n\n  futureClass = []\n  futureAnnotClass = []\n\n  componentDidUpdate(prevState) {\n    for (var i = 0; i < prevState.classes; i++) {\n      const cls = prevState.classes[i]\n      if (cls\n        && (this.state.classes[i] !== cls.name)\n        && (this.state.enables[i] !== cls.enabled)\n      ) {\n        return true\n      }\n    }\n    for (i = 0; i < prevState.annotClasses; i++) {\n      const annotCls = prevState.annotClasses[i]\n      if (annotCls\n        && (this.state.annotClasses[i] !== annotCls)\n      ) {\n        return true\n      }\n    }\n    return false\n  }\n\n  filter(sel, enabled) {\n    const classes = getClasses();\n    toggleClassEnable(sel);\n    filterClasses(classes[sel]);\n  }\n\n  updateAnnotClasses(annots) {\n    for (var i = 0; i < annots.length; i++){\n      const cls = annots[i]\n      if (!this.state.annotClasses.includes(cls.class) && !this.futureAnnotClass.includes(cls.class)) {\n        this.futureAnnotClass.push(cls.class)\n        this.setState(prevState => ({\n          ...prevState,\n          annotClasses: [\n            ...prevState.annotClasses,\n            cls.class\n          ],\n        }));\n      }\n    }\n  }\n\n  updateClasses(classes) {\n    for (var i = 0; i < classes.length; i++){\n      const idx = i;\n      const cls = classes[idx]\n      if (!this.state.classes.includes(cls.name) && !this.futureClass.includes(cls.name)) {\n        this.futureClass.push(cls.name)\n        this.setState(prevState => ({\n          ...prevState,\n          classes: [\n            ...prevState.classes,\n            cls.name,\n          ]\n        }));\n      }\n\n      this.setState( prevState => {\n        const enables = prevState.enables.map((en, j) => {\n          if (j === idx) {\n            return cls.enabled\n          }\n          else {\n            return en\n          }\n        })\n        return {\n          enables\n        }\n      })\n    }\n  }\n\n  display () {\n    const classes = getClasses();\n    var divs = []\n    for (var i = 0; i < classes.length; i++) {\n      const sel = i\n      const enabled = classes[sel].enabled\n      divs.push (\n        <Button\n          outline\n          color=\"primary\"\n          id=\"annot1Btn\"\n          onClick={() => {\n            this.filter(sel, !enabled);\n          }}\n          active={enabled}\n        >\n          {classes[sel].name}\n        </Button>\n      )\n    }\n    return (\n      <div>\n        <div className=\"annotations-class\" style={cardStyle}>\n\n          <Card style={card}>\n            <CardBody>\n              <CardTitle> Annotated Class Selection </CardTitle>\n            </CardBody>\n            {divs}\n          </Card>\n        </div>\n\n        <br></br>\n      </div>\n    )\n  };\n\n  render() {\n    annotApi.subscribe(state => {\n      if (state) {\n        updateClasses()\n        this.updateAnnotClasses(state.annotations)\n      }\n    })\n    annotClassApi.subscribe(state => {\n      if (state) {\n        this.updateClasses(state.classes);\n      }\n    })\n    return (\n      <div>\n        {this.display()}\n      </div>\n    );\n  }\n}\n\nexport default AnnotatorViewer;\n","import React from 'react';\n\nimport { thumb, thumbInner } from '../style.js';\nimport { fApi } from '../../utils/index.js';\nimport { fabric } from 'fabric';\n\nclass Thumbnails extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.selected = 0;\n    this.files = [];\n    this.canvasRef = React.createRef();\n    this.canvas = null\n  }\n\n  componentDidMount() {\n    this.canvas = new fabric.Canvas(this.canvasRef.current);\n  }\n\n  setSelected(idx) {\n    if (this.selected !== idx) {\n      fApi.setState(prevState => ({\n        ...prevState,\n        selected: idx,\n      }));\n      this.selected = idx;\n    }\n  }\n\n  updateForFile(state) {\n    if (state && (state.file.length > 0) && (state.file.length !== this.files.length)) {\n\n      const tiffFiles = state.file.filter(file => file.type === \"image/tiff\")\n      for (var i = this.files.length; i < tiffFiles.length; i++) {\n        const idx = tiffFiles.length - 1\n        const file = tiffFiles[idx]\n\n        const newFile = {\n          rgba: file.rgba,\n          width: file.image.width,\n          height: file.image.height,\n          page: file.pages[0],\n          name: file.name,\n          type: file.type\n        }\n\n        this.files.push(newFile)\n      }\n      this.forceUpdate();\n    }\n  }\n\n  classicImage = (file, idx) => {\n    return(\n            <div style={thumb} key={file.name}>\n              <div style={thumbInner}>\n                <img\n                  src={file.image}\n                  style={file.style}\n                  alt={file.name}\n                  onClick={() => this.setSelected(idx)}\n                />\n              </div>\n            </div>\n    )\n  }\n\n  allThumbs = () => {\n    var elements = [];\n\n    if (fApi.getState().file) {\n      fApi.getState().file.map ((file, idx) => {\n        if (file.type === \"image/png\"\n        ){\n          elements.push (\n            this.classicImage(file, idx)\n          )\n        }\n        return null;\n      });\n    }\n\n    return (\n      <div>\n        {elements}\n      </div>\n    );\n  }\n\n  shrinkTiff(context, imageData, idx) {\n    const cw = 50\n    const ch = 50\n    const imgW = imageData.width\n    const imgH = imageData.height\n\n    var newC = document.createElement('canvas')\n    newC.width = imgW\n    newC.height = imgH\n    newC.getContext('2d').putImageData(imageData, 0, 0)\n\n    var x = (cw+10) * idx\n    var y = 0\n    context.drawImage(newC, x, y, cw, ch)\n  }\n\n  loadTiff(context) {\n    for (var f = 0; f < this.files.length; f++) {\n\n      const file = this.files[f]\n      var page = null\n      if (file ) {\n        page = file.page\n      }\n      if (page && (file.width > 0) && (file.height > 0)) {\n        const imageData = context.createImageData(\n          file.width,\n          file.height\n        );\n\n        for (let idx = 0; idx < page.length; idx++) {\n          imageData.data[idx] = page[idx];\n        }\n\n        this.shrinkTiff(context, imageData, f)\n      }\n    }\n  }\n\n  allTiffsCanvas = () => {\n    if (this.canvas) this.loadTiff(this.canvas.getContext('2d'))\n    return (\n      <div>\n        <canvas\n          ref={this.canvasRef}\n          width=\"1000px\"\n          height=\"1000px\"\n          margin=\"0px\"\n          id=\"tiff-canvas\"\n        />\n      </div>\n    );\n  }\n\n  display() {\n    return (\n      <div>\n        {this.allThumbs()}\n        {this.allTiffsCanvas()}\n      </div>\n    )\n  }\n\n  render() {\n\n    fApi.subscribe(state => {\n      this.updateForFile(state)\n      this.forceUpdate()\n    })\n\n    return (\n      <div id=\"thumbsContainer\">\n        {this.display()}\n      </div>\n    );\n  }\n}\n\nexport default Thumbnails;\n","import create from 'zustand';\nimport { settingsApi } from '../mainSettings.js';\n\nexport const initState = () => {\n  return settingsApi.getState().dev ? devState : prodState;\n};\nexport const prodState = {\n  img_name: '',\n  annotations: [],\n};\n\nexport const devState = {};\n\nexport const [useAnnotStore, annotApi] = create(set => ({\n  ...initState(),\n}));\n","import csv from 'csvtojson';\nimport { saveJson, updateTiffPages } from '../fileuploader/fileControl.js';\nimport UTIF  from \"utif\"\n\nexport function importCsv(file) {\n  const reader = new FileReader();\n\n  reader.onload = () => {\n    const fileAsBinaryString = reader.result;\n\n    csv({\n      noheader: true,\n      output: 'json',\n    })\n      .fromString(fileAsBinaryString)\n      .then(csvRows => {\n        const toJson = [];\n        csvRows.forEach((aCsvRow, i) => {\n          if (i !== 0) {\n            const builtObject = {};\n\n            Object.keys(aCsvRow).forEach(aKey => {\n              const valueToAddInBuiltObject = aCsvRow[aKey];\n              const keyToAddInBuiltObject = csvRows[0][aKey];\n              builtObject[keyToAddInBuiltObject] = valueToAddInBuiltObject;\n            });\n\n            toJson.push(builtObject);\n          }\n        });\n        saveJson(toJson);\n      });\n  };\n\n  reader.onabort = () => console.log('file reading was aborted');\n  reader.onerror = () => console.log('file reading has failed');\n\n  reader.readAsText(file, 'ISO-8859-1');\n}\n\nexport function importJson(file) {\n  const reader = new FileReader();\n  let json;\n  reader.onload = () => {\n    json = JSON.parse(reader.result);\n    saveJson(json.annotations);\n  };\n  reader.readAsText(file);\n}\n\nexport function importTiff(file) {\n  const reader = new FileReader();\n\n  if (file) {\n    reader.onload = () => {\n      var success = file.type === 'image/tiff';\n      if (success) {\n          console.debug(\"importer::importTiff() - Loading TIFF image...\", file.name);\n        }\n\n      }\n      reader.onloadend = (event) => {\n        console.debug(\"importer::importTiff() - Parsing TIFF image...\", file.name);\n        parseMultiTiff(file.name, event.target.result);\n      }\n    reader.onprogress = () => {\n        console.log(\"importer::importTiff()\", \"Still Loading...\", file.name)\n      }\n    reader.readAsArrayBuffer(file);\n  }\n}\n\nexport function parseMultiTiff(name, buffer) {\n\n  var pages = []\n  const ifds = UTIF.decode(buffer);\n\n  for (var i = 0; i < ifds.length; i++) {\n    const idx = i\n    UTIF.decodeImage(buffer, ifds[idx]);\n    var rgba = UTIF.toRGBA8(ifds[idx]);\n    pages.push(rgba)\n  }\n\n  var image = new Image(ifds[0].width, ifds[0].height)\n  updateTiffPages(name, pages, image)\n}\n","import { fileApi } from './fileStore.js';\nimport { annotApi } from '../annotator/annotStore.js';\nimport { addAnnotation } from '../annotator/annotationControl.js';\nimport {\n  createTexture,\n  createTextureFromTiff,\n} from '../imagecanvas/ImageStore.js';\nimport { importCsv, importJson, importTiff } from '../annotator/importer.js';\n\nconst img = {\n  display: 'block',\n  width: 'auto',\n  height: '100%',\n};\n\nvar idx = 0;\n\nexport function isFirstFile() {\n  return fileApi.getState().size === 0;\n}\n\nexport function isValidFile(name) {\n  // check if file is already uploaded\n  var validFile = false;\n\n  fileApi.setState(prevState => {\n    if (prevState.file) {\n      const x = prevState.file.filter(file => file.name === name);\n      if (x.length === 0) {\n        validFile = true;\n      }\n    }\n  });\n  return validFile;\n}\n\nexport function initPng(file) {\n  fileApi.setState(prevState => ({\n    ...prevState,\n    file: [\n      {\n        name: file.name,\n        image: file.preview,\n        style: img,\n        type: file.type,\n        texture: createTexture(file.preview),\n      },\n    ],\n    size: prevState.size + 1,\n  }));\n  idx = fileApi.getState().size - 1;\n}\n\nexport function addPng(file) {\n  fileApi.setState(prevState => ({\n    ...prevState,\n    file: [\n      ...prevState.file,\n      {\n        name: file.name,\n        image: file.preview,\n        style: img,\n        type: file.type,\n        texture: createTexture(file.preview),\n      },\n    ],\n    size: prevState.size + 1,\n  }));\n  idx = fileApi.getState().size - 1;\n}\n\nexport function initTiff(file) {\n  fileApi.setState(prevState => ({\n    ...prevState,\n    file: [\n      ...prevState.file,\n      {\n        name: file.name,\n        image: file.preview,\n        style: img,\n        type: file.type,\n      },\n    ],\n    size: prevState.size + 1,\n  }));\n  importTiff(file);\n  idx = fileApi.getState().size - 1;\n}\n\nexport function addTiff(file) {\n  fileApi.setState( prevState => ({\n    ...prevState,\n    file: [...prevState.file, {\n      name: file.name,\n      image: file.preview,\n      style: img,\n      type: file.type\n    }],\n    size: prevState.size + 1\n  }))\n  importTiff(file);\n  idx = fileApi.getState().size - 1;\n}\n\nexport function updateTiff(image, rgba) {\n  fileApi.setState( prevState => {\n    const file = prevState.file.map((file, j) => {\n      var newFile = file;\n      newFile.texture = createTextureFromTiff(image.src)\n      newFile.image = image\n      newFile.rgba = rgba\n      return newFile;\n    })\n    return {\n      file\n    }\n  })\n\n}\n\nexport function updateTiffPages(name, pages, image) {\n  fileApi.setState( prevState => {\n    const file = prevState.file.map((file, j) => {\n      if (file.name === name) {\n        var newFile = file;\n        newFile.pages = pages\n        newFile.image = image\n        return newFile;\n      }\n      else {\n        return file\n      }\n    })\n    return {\n      file\n    }\n  })\n\n}\n\nexport function initCsv(file) {\n  fileApi.setState(prevState => ({\n    ...prevState,\n    file: [\n      {\n        name: file.name,\n        type: file.type,\n        json: importCsv(file),\n      },\n    ],\n    size: prevState.size + 1,\n  }));\n  idx = fileApi.getState().size - 1;\n}\n\nexport function addCsv(file) {\n  fileApi.setState(prevState => ({\n    ...prevState,\n    file: [\n      ...prevState.file,\n      {\n        name: file.name,\n        type: file.type,\n        json: importCsv(file),\n      },\n    ],\n    size: prevState.size + 1,\n  }));\n  idx = fileApi.getState().size - 1;\n}\n\nexport function initJson(file) {\n  fileApi.setState(prevState => ({\n    ...prevState,\n    file: [\n      {\n        name: file.name,\n        type: file.type,\n        json: importJson(file),\n      },\n    ],\n    size: prevState.size + 1,\n  }));\n  idx = fileApi.getState().size - 1;\n}\n\nexport function addJson(file) {\n  fileApi.setState(prevState => ({\n    ...prevState,\n    file: [\n      ...prevState.file,\n      {\n        name: file.name,\n        type: file.type,\n        json: importJson(file),\n      },\n    ],\n    size: prevState.size + 1,\n  }));\n  idx = fileApi.getState().size - 1;\n}\n\nfunction isAnnotValid(annotation) {\n  return (\n    annotation &&\n    annotation.rect.left > 0 &&\n    annotation.rect.left < 1000 &&\n    annotation.rect.top > 0 &&\n    annotation.rect.top < 1000 &&\n    annotation.rect.width > 0 &&\n    annotation.rect.width < 1000 &&\n    annotation.rect.height > 0 &&\n    annotation.rect.height < 1000 &&\n    annotation.label.length > 0\n  );\n}\n\nfunction addJsonAnnot(annotation) {\n  annotApi.setState(prevState => ({\n    img_name: fileApi.getState().file[idx].name,\n    annotations: prevState.annotations.concat(annotation),\n  }));\n  for (var i = 0; i < annotation.length; i++) {\n    if (isAnnotValid(annotation[i])) {\n      addAnnotation(annotation[i].rect, annotation[i].label);\n    }\n  }\n}\n\nexport function saveJson(result) {\n  fileApi.setState(prevState => {\n    const file = prevState.file.map((f, i) => {\n      if (i === idx) {\n        var newFile = f;\n        f.json = result;\n        return newFile;\n      } else {\n        return f;\n      }\n    });\n    return file;\n  });\n\n  addJsonAnnot(result);\n}\n","import React, { useEffect, useState } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport {\n  initPng,\n  addPng,\n  initTiff,\n  addTiff,\n  initCsv,\n  addCsv,\n  initJson,\n  addJson,\n  isFirstFile,\n  isValidFile,\n} from './fileControl.js';\n\nfunction addFile(file) {\n  if (file.type === 'image/png') {\n    addPng(file);\n  } else if (file.type === 'image/tiff') {\n    addTiff(file);\n  } else if (file.type === 'text/csv') {\n    addCsv(file);\n  } else if (file.type === 'application/json') {\n    addJson(file);\n  }\n}\n\nfunction initFile(file) {\n  if (file.type === 'image/png') {\n    initPng(file);\n  } else if (file.type === 'image/tiff') {\n    initTiff(file);\n  } else if (file.type === 'text/csv') {\n    initCsv(file);\n  } else if (file.type === 'application/json') {\n    initJson(file);\n  }\n}\n\nexport function FileUpload(props) {\n  const [files, setFiles] = useState([]);\n  const { getRootProps, getInputProps } = useDropzone({\n    accept: 'image/png, image/tiff, .csv, .json',\n    onDrop: acceptedFiles => {\n      setFiles(\n        acceptedFiles.map(file =>\n          Object.assign(file, {\n            preview: URL.createObjectURL(file),\n          })\n        )\n      );\n    },\n  });\n\n  const update = files.map(file => {\n    if (isValidFile(file.name)) {\n      if (isFirstFile()) {\n        initFile(file);\n      } else {\n        addFile(file);\n      }\n    }\n    return null;\n  });\n\n  useEffect(\n    () => () => {\n      // Make sure to revoke the data uris to avoid memory leaks\n      files.forEach(file => URL.revokeObjectURL(file.preview));\n    },\n    [files]\n  );\n\n  return (\n    <section className=\"container\">\n      <div {...getRootProps({ className: 'dropzone' })}>\n        <input {...getInputProps()} />\n        <p> {props.name} </p>\n        {update}\n      </div>\n    </section>\n  );\n}\n","import { annotApi } from './annotationStore.js';\n\nexport function exportJson() {\n  const element = document.createElement('a');\n\n  const file = new Blob([JSON.stringify(annotApi.getState())], {\n    type: 'text/plain',\n  });\n  element.href = URL.createObjectURL(file);\n  element.download = 'annotations.txt';\n  document.body.appendChild(element); // Required for this to work in FireFox\n  element.click();\n}\n","import React from 'react';\n\nimport { buttonGroup } from '../style.js';\nimport {\n  UncontrolledButtonDropdown,\n  DropdownToggle,\n  DropdownMenu,\n  DropdownItem,\n  ButtonGroup,\n  Button,\n} from 'reactstrap';\n\nimport { FileUpload } from '../../fileuploader/index.js';\nimport { exportJson } from '../../annotator/exporter.js';\n\nimport {\n  modes,\n  setMode,\n} from '../../fabric/fabricControl.js'\nimport {\n  undo,\n  redo,\n} from '../../annotator/editControl.js'\n\nclass Menus extends React.Component {\n  render() {\n    return (\n      <ButtonGroup\n        size={buttonGroup.size}\n        vertical={buttonGroup.vertical}\n        style={buttonGroup}\n      >\n        <UncontrolledButtonDropdown>\n          <DropdownToggle caret color=\"primary\">\n            File\n          </DropdownToggle>\n          <DropdownMenu>\n            <DropdownItem>\n              <Button\n                outline\n                color=\"primary\"\n                className=\"export-btn\"\n                onClick={exportJson}\n              >\n                {' '}\n                Export Annotations{' '}\n              </Button>\n            </DropdownItem>\n          </DropdownMenu>\n        </UncontrolledButtonDropdown>\n\n        <UncontrolledButtonDropdown>\n          <DropdownToggle caret color=\"primary\">\n            Draw\n          </DropdownToggle>\n          <DropdownMenu>\n            <Button\n              outline\n              color=\"primary\"\n              className=\"draw-rectangle-btn\"\n              onClick={(e) => setMode(modes.RECT)}\n            >\n              Rectangle\n            </Button>\n            <Button\n              outline\n              color=\"primary\"\n              className=\"draw-rectangle-btn\"\n              onClick={(e) => setMode(modes.FREE)}\n            >\n              Freehand\n            </Button>\n          </DropdownMenu>\n        </UncontrolledButtonDropdown>\n\n        <UncontrolledButtonDropdown>\n          <DropdownToggle caret color=\"primary\">\n            Edit\n          </DropdownToggle>\n          <DropdownMenu>\n            <Button\n              outline\n              color=\"primary\"\n              className=\"draw-rectangle-btn\"\n              onClick={(e) => undo()}\n            >\n              Undo\n            </Button>\n            <Button\n              outline\n              color=\"primary\"\n              className=\"draw-rectangle-btn\"\n              onClick={(e) => redo()}\n            >\n              Redo\n            </Button>\n          </DropdownMenu>\n        </UncontrolledButtonDropdown>\n\n        <Button outline color=\"primary\" className=\"import-btn\">\n          {' '}\n          <FileUpload name=\"Import File\" />{' '}\n        </Button>\n      </ButtonGroup>\n    );\n  }\n}\n\nexport default Menus;\n","import React from 'react';\nimport { fileApi } from '../fileuploader/fileStore.js';\nimport { annotApi } from '../annotator/annotStore.js'\n\nclass Annotator extends React.Component {\n  file_size = 0;\n  annotations = {};\n\n  render() {\n    fileApi.subscribe(state => {\n      if (this.file_size !== state.size) {\n        this.file_size = state.size;\n\n        console.log('fileApi - files: ', state.file);\n      }\n    });\n    annotApi.subscribe(state => {\n      if (this.annotations !== state.annotations) {\n        this.annotations = state.annotations;\n\n        console.log('annotApi - annotations: ', state.annotations);\n      }\n    });\n    return <div id=\"annotator-div\"></div>;\n  }\n}\n\nexport default Annotator;\n","import { uApi } from '../utils/index.js';\nimport { createTexture, createTextureFromTiff } from './ImageStore.js';\nimport * as THREE from 'three';\n\nfunction isValidChannel(channel) {\n  return (\n    uApi.getState() &&\n    uApi.getState().channels.length > 0 &&\n    channel >= 1 &&\n    uApi.getState().channels[channel - 1] &&\n    uApi.getState().channels[channel - 1].uniforms.contrast &&\n    uApi.getState().channels[channel - 1].uniforms.brightness &&\n    uApi.getState().channels[channel - 1].uniforms.color\n  );\n}\n\nfunction updateUniformBrightness(value, channel) {\n  uApi.setState(prevState => {\n    const channels = prevState.channels.map((ch, j) => {\n      if (j === channel - 1) {\n        var newChannel = ch;\n        newChannel.uniforms.brightness.value = value;\n        return newChannel;\n      } else {\n        return ch;\n      }\n    });\n    return {\n      channels,\n    };\n  });\n}\n\nfunction updateUniformContrast(value, channel) {\n  uApi.setState(prevState => {\n    const channels = prevState.channels.map((ch, j) => {\n      if (j === channel - 1) {\n        var newChannel = ch;\n        newChannel.uniforms.contrast.value = value;\n        return newChannel;\n      } else {\n        return ch;\n      }\n    });\n    return {\n      channels,\n    };\n  });\n}\n\nfunction updateUniformWhitepoint(value, channel) {\n  uApi.setState(prevState => {\n    const channels = prevState.channels.map((ch, j) => {\n      if (j === channel - 1) {\n        var newChannel = ch;\n        newChannel.uniforms.whitepoint.value = value;\n        return newChannel;\n      } else {\n        return ch;\n      }\n    });\n    return {\n      channels,\n    };\n  });\n}\n\nfunction updateUniformBlackpoint(value, channel) {\n  uApi.setState(prevState => {\n    const channels = prevState.channels.map((ch, j) => {\n      if (j === channel - 1) {\n        var newChannel = ch;\n        newChannel.uniforms.blackpoint.value = value;\n        return newChannel;\n      } else {\n        return ch;\n      }\n    });\n    return {\n      channels,\n    };\n  });\n}\n\nfunction updateUniformOpacity(value, channel) {\n  uApi.setState(prevState => {\n    const channels = prevState.channels.map((ch, j) => {\n      if (j === channel - 1) {\n        var newChannel = ch;\n        newChannel.uniforms.opacity.value = value;\n        return newChannel;\n      } else {\n        return ch;\n      }\n    });\n    return {\n      channels,\n    };\n  });\n}\n\nfunction updateUniformColor(value, channel) {\n  uApi.setState(prevState => {\n    const channels = prevState.channels.map((ch, j) => {\n      if (j === channel - 1) {\n        var newChannel = ch;\n        console.log('updateColorUniform: ', value);\n        newChannel.uniforms.color.value = value;\n        return newChannel;\n      } else {\n        return ch;\n      }\n    });\n    return {\n      channels,\n    };\n  });\n}\n\nexport function updateImage(file, channel) {\n  let name = file.name;\n  let blob = file.image;\n  let texture = file.texture;\n\n  if (texture === '') {\n    if (file.type === 'image/tiff') {\n      texture = createTextureFromTiff(blob);\n    } else {\n      texture = createTexture(blob);\n    }\n  }\n  const prevStateCh = uApi.getState().channels[channel - 1];\n\n  if (\n    prevStateCh.name !== name ||\n    prevStateCh.imagepath !== blob ||\n    prevStateCh.uniforms.image.value !== texture\n  ) {\n    updateUniformImage(texture, name, blob, channel);\n  }\n}\n\nexport function updateUniformImage(texture, name, imagepath, channel) {\n  uApi.setState(prevState => {\n    const channels = prevState.channels.map((ch, j) => {\n      if (j === channel - 1) {\n        var newChannel = ch;\n\n        newChannel.name = name;\n        newChannel.imagepath = imagepath;\n        newChannel.uniforms.image.value = texture;\n        return newChannel;\n      } else {\n        return ch;\n      }\n    });\n    return {\n      channels,\n    };\n  });\n}\n\nexport function updateBrightness(value, channel) {\n  if (isValidChannel(channel)) {\n    if (\n      value !== uApi.getState().channels[channel - 1].uniforms.brightness.value\n    ) {\n      updateUniformBrightness(value, channel);\n    }\n    return true;\n  } else {\n    console.log(\n      'CanvasControl::UpdateBrighness() - null state',\n      uApi.getState(),\n      ' channel: ',\n      channel,\n      ' value: ',\n      value\n    );\n  }\n  return false;\n}\n\nexport function updateContrast(value, channel) {\n  if (isValidChannel(channel)) {\n    if (\n      value !== uApi.getState().channels[channel - 1].uniforms.contrast.value\n    ) {\n      updateUniformContrast(value, channel);\n    }\n    return true;\n  } else {\n    console.log(\n      'CanvasControl::updateContrast() - null state',\n      uApi.getState(),\n      ' channel: ',\n      channel,\n      ' value: ',\n      value\n    );\n  }\n  return false;\n}\n\nexport function updateWhitepoint(value, channel) {\n  if (isValidChannel(channel)) {\n    if (\n      value !== uApi.getState().channels[channel - 1].uniforms.whitepoint.value\n    ) {\n      updateUniformWhitepoint(value, channel);\n    }\n    return true;\n  } else {\n    console.log(\n      'CanvasControl::updateWhitepoint() - null state',\n      uApi.getState(),\n      ' channel: ',\n      channel,\n      ' value: ',\n      value\n    );\n  }\n  return false;\n}\n\nexport function updateBlackpoint(value, channel) {\n  if (isValidChannel(channel)) {\n    if (\n      value !== uApi.getState().channels[channel - 1].uniforms.blackpoint.value\n    ) {\n      updateUniformBlackpoint(value, channel);\n    }\n    return true;\n  } else {\n    console.log(\n      'CanvasControl::updateBlackpoint() - null state',\n      uApi.getState(),\n      ' channel: ',\n      channel,\n      ' value: ',\n      value\n    );\n  }\n  return false;\n}\n\nexport function updateOpacity(value, channel) {\n  if (isValidChannel(channel)) {\n    if (\n      value !== uApi.getState().channels[channel - 1].uniforms.opacity.value\n    ) {\n      updateUniformOpacity(value, channel);\n    }\n    return true;\n  } else {\n    console.log(\n      'CanvasControl::updateOpacity() - null state',\n      uApi.getState(),\n      ' channel: ',\n      channel,\n      ' value: ',\n      value\n    );\n  }\n  return false;\n}\n\nexport function updateColor(value, channel) {\n  var color = new THREE.Color(value.color);\n\n  if (isValidChannel(channel)) {\n    if (value !== uApi.getState().channels[channel - 1].uniforms.color.value) {\n      console.log(\n        'CanvasControl::updateColor() - value', value, color);\n      updateUniformColor(color, channel);\n    }\n    return true;\n  } else {\n    console.log(\n      'CanvasControl::updateColor() - null state',\n      uApi.getState(),\n      ' channel: ',\n      channel,\n      ' value: ',\n      value\n    );\n  }\n  return false;\n}\n\n","import React from 'react';\nimport { fApi, uApi } from '../utils/index.js';\nimport { updateImage } from './CanvasControl.js';\nimport { canvasApi } from './canvasStore.js';\n\nclass ImageCanvas extends React.Component {\n  updateForFile(state) {\n    if (state) {\n      updateImage(state.file[state.selected], this.props.channel);\n    }\n    this.forceUpdate();\n  }\n  updateForControls(state) {\n    this.forceUpdate();\n  }\n\n  render() {\n    fApi.subscribe(state => {\n      this.updateForFile(state);\n    });\n    uApi.subscribe(state => {\n      this.updateForControls(state);\n    });\n\n    return canvasApi.getState().canvas[this.props.channel - 1];\n  }\n}\n\nexport default ImageCanvas;\n","import React from 'react';\nimport { SketchPicker } from 'react-color';\nimport reactCSS from 'reactcss';\n\nclass ColorPicker extends React.Component {\n  state = {\n    displayColorPicker: false,\n    color: {\n      r: '241',\n      g: '112',\n      b: '19',\n      a: '1',\n    },\n  };\n\n  handleClick = () => {\n    this.setState({ displayColorPicker: !this.state.displayColorPicker });\n  };\n\n  handleClose = () => {\n    this.setState({ displayColorPicker: false });\n  };\n\n  handleChange = color => {\n    this.setState({ color: color.rgb });\n  };\n\n  handleChangeComplete = color => {\n    this.setState({ color: color.rgb });\n    this.props.onClick({ color: color.hex  });\n  };\n\n  render() {\n    const styles = reactCSS({\n      default: {\n        color: {\n          width: '36px',\n          height: '14px',\n          borderRadius: '2px',\n          background: `rgba(${this.state.color.r}, ${this.state.color.g}, ${this.state.color.b}, ${this.state.color.a})`,\n        },\n        swatch: {\n          padding: '5px',\n          background: '#fff',\n          borderRadius: '1px',\n          boxShadow: '0 0 0 1px rgba(0,0,0,.1)',\n          display: 'inline-block',\n          cursor: 'pointer',\n        },\n        popover: {\n          position: 'absolute',\n          zIndex: '2',\n        },\n        cover: {\n          position: 'fixed',\n          top: '0px',\n          right: '0px',\n          bottom: '0px',\n          left: '0px',\n        },\n      },\n    });\n\n    return (\n      <div>\n        <div style={styles.swatch} onClick={this.handleClick}>\n          <div style={styles.color} />\n        </div>\n        {this.state.displayColorPicker ? (\n          <div style={styles.popover}>\n            <div style={styles.cover} onClick={this.handleClose} />\n            <SketchPicker\n              color={this.state.color}\n              onChange={this.handleChange}\n              onChangeComplete={this.handleChangeComplete}\n            />\n          </div>\n        ) : null}\n      </div>\n    );\n  }\n}\nexport default ColorPicker;\n","import React from 'react';\n\nimport { card, cardBody, canvasThumbnail } from '../style.js';\nimport { Button, UncontrolledCollapse, Card, CardBody } from 'reactstrap';\n\nimport ImageCanvas from '../../imagecanvas/ImageCanvas.js';\nimport Slider from './slider.js';\nimport {\n  updateBrightness,\n  updateContrast,\n  updateWhitepoint,\n  updateBlackpoint,\n  updateColor,\n  updateOpacity,\n} from '../../imagecanvas/CanvasControl.js';\nimport {\n  updateChannelSel,\n  updateLastSel,\n  settingsApi,\n} from '../../mainSettings.js';\nimport ColorPicker from './colorPicker.js';\n\nclass Channel extends React.Component {\n  updateSelection = () => {\n    updateChannelSel(this.props.ch);\n    updateLastSel(this.props.ch);\n    this.forceUpdate();\n  };\n\n  sliderValueBr(value) {\n    updateBrightness(value, this.props.ch);\n  }\n\n  sliderValueCt(value) {\n    updateContrast(value, this.props.ch);\n  }\n\n  sliderValueWp(value) {\n    updateWhitepoint(value, this.props.ch);\n  }\n\n  sliderValueBp(value) {\n    updateBlackpoint(value, this.props.ch);\n  }\n\n  sliderValueOpc(value) {\n    updateOpacity(value, this.props.ch);\n  }\n\n  colorValue(value) {\n    updateColor(value, this.props.ch);\n  }\n\n  resetBrightness() {\n    updateBrightness('0.0', this.props.ch);\n  }\n\n  resetContrast() {\n    updateContrast('0.0', this.props.ch);\n  }\n\n  resetWhitepoint() {\n    updateWhitepoint('255.0', this.props.ch);\n  }\n\n  resetBlackpoint() {\n    updateBlackpoint('0.0', this.props.ch);\n  }\n\n  resetOpacity() {\n    updateOpacity('0.0', this.props.ch);\n  }\n\n  render() {\n    var sliderValueBr = this.sliderValueBr;\n    var sliderValueCt = this.sliderValueCt;\n    var sliderValueWp = this.sliderValueWp;\n    var sliderValueBp = this.sliderValueBp;\n    var sliderValueOpc = this.sliderValueOpc;\n    var colorValue = this.colorValue;\n\n    var alt = 'Ch' + this.props.ch + ' Histogram';\n    var canvas = (\n      <ImageCanvas\n        className=\"annot-view\"\n        alt={alt}\n        height=\"100px\"\n        channel={this.props.ch}\n      />\n    );\n    var sel = settingsApi.getState().channels[this.props.ch - 1].selected;\n\n    console.log('Channel ' + this.props.ch + ' : ' + sel);\n    return (\n      <div>\n        <Button\n          className=\"channelBtn\"\n          outline\n          color=\"primary\"\n          id=\"channel-btn\"\n          onClick={() => {\n            this.updateSelection();\n          }}\n          active={sel}\n        >\n          Channel {`${this.props.ch}`}\n        </Button>\n        <Button\n          className=\"viewBtn\"\n          outline\n          color=\"secondary\"\n          id={`view${this.props.ch}`}\n        >\n          View\n        </Button>\n        <UncontrolledCollapse toggler={`#view${this.props.ch}`}>\n          <Card style={card}>\n            <CardBody style={cardBody}>\n              <div style={canvasThumbnail}>{canvas}</div>\n              <div>Channel Color</div>\n              <ColorPicker\n                color={colorValue.bind(this)}\n                onClick={colorValue.bind(this)}\n              />\n              <br></br>\n              <div className=\"opacity-slider-container\">\n                <Slider\n                  label=\"Opacity\"\n                  width=\"40%\"\n                  min=\"0.0\"\n                  max=\"1.0\"\n                  step=\"0.1\"\n                  initial=\"0\"\n                  multiplier=\"100\"\n                  raw=\"0\"\n                  sliderValue={sliderValueOpc.bind(this)}\n                />\n                <button\n                  id=\"resetOpcBtn\"\n                  onClick={() => {\n                    this.resetOpacity();\n                  }}\n                >\n                  Reset Channel Opacity\n                </button>\n              </div>\n              <br></br>\n              <br></br>\n              <div className=\"brightness-slider-container\">\n                <Slider\n                  label=\"Brightness\"\n                  width=\"40%\"\n                  min=\"0\"\n                  max=\"1\"\n                  step=\"0.1\"\n                  initial=\"0\"\n                  multiplier=\"100\"\n                  raw=\"0\"\n                  sliderValue={sliderValueBr.bind(this)}\n                />\n                <button\n                  id=\"resetBrBtn\"\n                  onClick={() => {\n                    this.resetBrightness();\n                  }}\n                >\n                  Reset Brightness\n                </button>\n              </div>\n              <div className=\"contrast-slider-container\">\n                <Slider\n                  label=\"Contrast\"\n                  width=\"40%\"\n                  min=\"0\"\n                  max=\"10\"\n                  step=\"1\"\n                  initial=\"0\"\n                  multiplier=\"10\"\n                  raw=\"0\"\n                  sliderValue={sliderValueCt.bind(this)}\n                />\n                <button\n                  id=\"resetCtBtn\"\n                  onClick={() => {\n                    this.resetContrast();\n                  }}\n                >\n                  Reset Contrast\n                </button>\n              </div>\n              <div className=\"whitepoint-slider-container\">\n                <Slider\n                  label=\"Whitepoint\"\n                  width=\"40%\"\n                  min=\"0\"\n                  max=\"255\"\n                  step=\"1\"\n                  initial=\"255\"\n                  multiplier=\"1\"\n                  raw=\"1\"\n                  sliderValue={sliderValueWp.bind(this)}\n                />\n                <button\n                  id=\"resetWpBtn\"\n                  onClick={() => {\n                    this.resetWhitepoint();\n                  }}\n                >\n                  Reset Whitepoint\n                </button>\n              </div>\n              <div className=\"blackpoint-slider-container\">\n                <Slider\n                  label=\"Blackpoint\"\n                  width=\"40%\"\n                  min=\"0\"\n                  max=\"255\"\n                  step=\"1\"\n                  initial=\"0\"\n                  multiplier=\"1\"\n                  raw=\"1\"\n                  sliderValue={sliderValueBp.bind(this)}\n                />\n                <button\n                  id=\"resetBpBtn\"\n                  onClick={() => {\n                    this.resetBlackpoint();\n                  }}\n                >\n                  Reset Blackpoint\n                </button>\n              </div>\n            </CardBody>\n          </Card>\n        </UncontrolledCollapse>\n      </div>\n    );\n  }\n}\n\nexport default Channel;\n","import React from 'react';\n\nimport { cardStyle, card } from '../style.js';\nimport { Card, CardTitle, CardBody } from 'reactstrap';\n\nimport Channel from './channel.js';\n\nclass ChannelViewer extends React.Component {\n  render() {\n    return (\n      <div className=\"annotations-channel\" style={cardStyle}>\n        <Card style={card}>\n          <CardBody>\n            <CardTitle> Channel Selection </CardTitle>\n            <Channel ch=\"1\" />\n            <Channel ch=\"2\" />\n            <Channel ch=\"3\" />\n          </CardBody>\n        </Card>\n      </div>\n    );\n  }\n}\n\nexport default ChannelViewer;\n","import React from 'react';\nimport { mainStyle, rowStyle, container } from './style.js';\nimport MainViewer from './components/mainViewer.js';\nimport AxesViewer from './components/axesViewer.js';\nimport AnnotatorViewer from './components/annotatorViewer.js';\nimport Thumbnails from './components/thumbnails.js';\nimport Menus from './components/menus.js';\nimport Annotator from './../annotator/index.js';\nimport ChannelViewer from './components/channelViewer.js';\n\nimport { Container, Row, Col } from 'reactstrap';\n\nclass UI extends React.Component {\n  render() {\n    return (\n      <div className=\"main\" style={mainStyle}>\n        <Menus />\n        <br></br>\n        <br></br>\n        <br></br>\n\n        <Container style={container}>\n          <Row style={rowStyle}>\n            <Col xs=\"2\">\n              <AxesViewer />\n            </Col>\n\n            <Col xs=\"8\">\n              <MainViewer />\n            </Col>\n\n            <Col xs=\"2\">\n              <AnnotatorViewer />\n              <ChannelViewer />\n              <Thumbnails />\n            </Col>\n          </Row>\n        </Container>\n        <Annotator />\n      </div>\n    );\n  }\n}\n\nexport default UI;\n","import './styles.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport UI from './ui';\n\nfunction Application() {\n  return (\n    <>\n      <UI />\n    </>\n  );\n}\n\nconst rootElement = document.getElementById('root');\nReactDOM.render(<Application />, rootElement);\n"],"sourceRoot":""}