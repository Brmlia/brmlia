{"ast":null,"code":"import _classCallCheck from \"/Users/ramiroochoa/Desktop/brmlia/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ramiroochoa/Desktop/brmlia/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/ramiroochoa/Desktop/brmlia/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ramiroochoa/Desktop/brmlia/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/ramiroochoa/Desktop/brmlia/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/ramiroochoa/Desktop/brmlia/src/imagecanvas/ImageCanvas.js\";\nimport React from 'react';\nimport { Canvas } from 'react-three-fiber';\nimport Grid from '@material-ui/core/Grid';\nimport Mesh from './Mesh';\nimport { canvasStyle } from '../ui/style.js';\nimport { createTexture, createTextureFromTiff } from './imageStore.js';\nimport { fApi, uApi } from '../utils/index.js';\nimport { updateUniformImage } from './CanvasControl.js';\nimport { canvasApi } from './canvasStore.js';\n\nvar ImageCanvas = /*#__PURE__*/function (_React$Component) {\n  _inherits(ImageCanvas, _React$Component);\n\n  function ImageCanvas() {\n    _classCallCheck(this, ImageCanvas);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ImageCanvas).apply(this, arguments));\n  }\n\n  _createClass(ImageCanvas, [{\n    key: \"updateForFile\",\n    value: function updateForFile(state) {\n      if (uApi.getState().name !== state.file[state.selected].name) {\n        var texture = createTexture(state.file[state.selected].image);\n\n        if (state.file[state.selected].type === 'image/tiff') {\n          console.log('tiff detected ==> converting to canvas');\n          texture = createTextureFromTiff(state.file[state.selected].image);\n        }\n\n        updateUniformImage(texture, state.file[state.selected].name, this.props.channel);\n        this.forceUpdate();\n      }\n    }\n  }, {\n    key: \"updateForControls\",\n    value: function updateForControls(state) {\n      this.forceUpdate();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this = this;\n\n      fApi.subscribe(function (state) {\n        _this.updateForFile(state);\n      });\n      uApi.subscribe(function (state) {\n        _this.updateForControls(state);\n      });\n      return React.createElement(\"div\", {\n        class: \"image-canvas-container\",\n        style: canvasStyle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 39\n        },\n        __self: this\n      }, React.createElement(Canvas, {\n        className: \"image-canvas\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 40\n        },\n        __self: this\n      }, canvasApi.getState().canvas[this.props.channel - 1]));\n    }\n  }]);\n\n  return ImageCanvas;\n}(React.Component);\n\nexport default ImageCanvas;","map":{"version":3,"sources":["/Users/ramiroochoa/Desktop/brmlia/src/imagecanvas/ImageCanvas.js"],"names":["React","Canvas","Grid","Mesh","canvasStyle","createTexture","createTextureFromTiff","fApi","uApi","updateUniformImage","canvasApi","ImageCanvas","state","getState","name","file","selected","texture","image","type","console","log","props","channel","forceUpdate","subscribe","updateForFile","updateForControls","canvas","Component"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,MAAT,QAAuB,mBAAvB;AACA,OAAOC,IAAP,MAAiB,wBAAjB;AACA,OAAOC,IAAP,MAAiB,QAAjB;AACA,SAASC,WAAT,QAA4B,gBAA5B;AACA,SAASC,aAAT,EAAwBC,qBAAxB,QAAqD,iBAArD;AACA,SAASC,IAAT,EAAeC,IAAf,QAA2B,mBAA3B;AACA,SAASC,kBAAT,QAAmC,oBAAnC;AACA,SAAQC,SAAR,QAAwB,kBAAxB;;IAEMC,W;;;;;;;;;;;kCAEUC,K,EAAO;AACnB,UAAIJ,IAAI,CAACK,QAAL,GAAgBC,IAAhB,KAAyBF,KAAK,CAACG,IAAN,CAAWH,KAAK,CAACI,QAAjB,EAA2BF,IAAxD,EAA8D;AAE5D,YAAIG,OAAO,GAAGZ,aAAa,CAACO,KAAK,CAACG,IAAN,CAAWH,KAAK,CAACI,QAAjB,EAA2BE,KAA5B,CAA3B;;AACA,YAAIN,KAAK,CAACG,IAAN,CAAWH,KAAK,CAACI,QAAjB,EAA2BG,IAA3B,KAAoC,YAAxC,EAAsD;AACpDC,UAAAA,OAAO,CAACC,GAAR,CAAY,wCAAZ;AACAJ,UAAAA,OAAO,GAAGX,qBAAqB,CAACM,KAAK,CAACG,IAAN,CAAWH,KAAK,CAACI,QAAjB,EAA2BE,KAA5B,CAA/B;AACD;;AAEDT,QAAAA,kBAAkB,CAACQ,OAAD,EAAUL,KAAK,CAACG,IAAN,CAAWH,KAAK,CAACI,QAAjB,EAA2BF,IAArC,EAA2C,KAAKQ,KAAL,CAAWC,OAAtD,CAAlB;AACA,aAAKC,WAAL;AACD;AACF;;;sCACiBZ,K,EAAO;AACvB,WAAKY,WAAL;AACD;;;6BAEQ;AAAA;;AACPjB,MAAAA,IAAI,CAACkB,SAAL,CAAe,UAAAb,KAAK,EAAK;AACvB,QAAA,KAAI,CAACc,aAAL,CAAmBd,KAAnB;AACD,OAFD;AAGAJ,MAAAA,IAAI,CAACiB,SAAL,CAAe,UAAAb,KAAK,EAAK;AACvB,QAAA,KAAI,CAACe,iBAAL,CAAuBf,KAAvB;AACD,OAFD;AAIA,aACE;AAAK,QAAA,KAAK,EAAC,wBAAX;AAAoC,QAAA,KAAK,EAAER,WAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,MAAD;AAAQ,QAAA,SAAS,EAAC,cAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGM,SAAS,CAACG,QAAV,GAAqBe,MAArB,CAA4B,KAAKN,KAAL,CAAWC,OAAX,GAAmB,CAA/C,CADH,CADF,CADF;AAOD;;;;EAlCuBvB,KAAK,CAAC6B,S;;AAqChC,eAAelB,WAAf","sourcesContent":["import React from 'react';\nimport { Canvas } from 'react-three-fiber';\nimport Grid from '@material-ui/core/Grid';\nimport Mesh from './Mesh';\nimport { canvasStyle } from '../ui/style.js'\nimport { createTexture, createTextureFromTiff } from './imageStore.js'\nimport { fApi, uApi } from '../utils/index.js'\nimport { updateUniformImage } from './CanvasControl.js'\nimport {canvasApi} from './canvasStore.js'\n\nclass ImageCanvas extends React.Component {\n\n  updateForFile(state) {\n    if (uApi.getState().name !== state.file[state.selected].name) {\n\n      let texture = createTexture(state.file[state.selected].image);\n      if (state.file[state.selected].type === 'image/tiff') {\n        console.log('tiff detected ==> converting to canvas');\n        texture = createTextureFromTiff(state.file[state.selected].image);\n      }\n\n      updateUniformImage(texture, state.file[state.selected].name, this.props.channel)\n      this.forceUpdate();\n    }\n  }\n  updateForControls(state) {\n    this.forceUpdate();\n  }\n\n  render() {\n    fApi.subscribe(state =>  {\n      this.updateForFile(state);\n    })\n    uApi.subscribe(state =>  {\n      this.updateForControls(state);\n    })\n\n    return (\n      <div class=\"image-canvas-container\" style={canvasStyle}>\n        <Canvas className='image-canvas' >\n          {canvasApi.getState().canvas[this.props.channel-1]}\n        </Canvas>\n      </div>\n    );\n  }\n}\n\nexport default ImageCanvas;\n"]},"metadata":{},"sourceType":"module"}